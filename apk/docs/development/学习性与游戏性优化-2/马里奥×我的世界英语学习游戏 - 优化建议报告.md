# é©¬é‡Œå¥¥Ã—æˆ‘çš„ä¸–ç•Œè‹±è¯­å­¦ä¹ æ¸¸æˆ - ä¼˜åŒ–å»ºè®®æŠ¥å‘Š

**é¡¹ç›®ç‰ˆæœ¬**: v1.8.17  
**åˆ†ææ—¥æœŸ**: 2026å¹´2æœˆ16æ—¥  
**æ ¸å¿ƒç†å¿µ**: å¹³è¡¡æ¸¸æˆæ€§ä¸å­¦ä¹ æ€§

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

åŸºäºé¡¹ç›®æ–‡æ¡£çš„æ·±åº¦åˆ†æï¼Œæœ¬æ¸¸æˆåœ¨"å­¦ä¹ ä¸æ¸¸æˆèåˆ"æ–¹é¢å·²æœ‰ä¼˜ç§€åŸºç¡€ï¼Œä½†åœ¨**å­¦ä¹ æ•ˆæœå¯é‡åŒ–**ã€**æ¸¸æˆæ€§æ·±åº¦**ã€**é•¿çº¿ç•™å­˜**ç­‰æ–¹é¢å­˜åœ¨ä¼˜åŒ–ç©ºé—´ã€‚æœ¬æŠ¥å‘Šæå‡º50+æ¡ä¼˜åŒ–å»ºè®®ï¼Œä¼˜å…ˆè§£å†³å­¦ä¹ æ•°æ®é—­ç¯ã€æ¸¸æˆèŠ‚å¥ä¼˜åŒ–å’ŒæŠ€æœ¯æ€§èƒ½ä¸‰å¤§æ ¸å¿ƒé—®é¢˜ã€‚

**å…³é”®å‘ç°**ï¼š
- âœ… å››å±‚å­¦ä¹ èåˆè®¾è®¡ç†å¿µå…ˆè¿›
- âœ… 12ç¾¤ç³»Ã—4Bossçš„å†…å®¹é‡å……è¶³
- âš ï¸ ç¼ºå°‘å­¦ä¹ æ•ˆæœçš„æ•°æ®é—­ç¯ä¸åé¦ˆ
- âš ï¸ æ¸¸æˆéš¾åº¦æ›²çº¿å­˜åœ¨é™¡å¡
- âš ï¸ 6000è¡Œå•æ–‡ä»¶å½±å“ç»´æŠ¤æ€§èƒ½

---

## ğŸ¯ ä¼˜åŒ–æ–¹å‘æ€»è§ˆ

```mermaid
graph TB
    A[ä¼˜åŒ–ç›®æ ‡] --> B[å­¦ä¹ æ•ˆæœå¯è§†åŒ–]
    A --> C[æ¸¸æˆæ€§æ·±åº¦æå‡]
    A --> D[æŠ€æœ¯æ¶æ„ä¼˜åŒ–]
    A --> E[ç”¨æˆ·ç•™å­˜æœºåˆ¶]
    
    B --> B1[è‡ªé€‚åº”å­¦ä¹ è·¯å¾„]
    B --> B2[å­¦ä¹ æ•°æ®ä»ªè¡¨ç›˜]
    B --> B3[ç§‘å­¦é—´éš”å¤ä¹ ]
    
    C --> C1[éš¾åº¦æ›²çº¿å¹³æ»‘]
    C --> C2[æˆ˜æ–—ç­–ç•¥æ·±åŒ–]
    C --> C3[ç¾¤ç³»å·®å¼‚åŒ–]
    
    D --> D1[ä»£ç æ¨¡å—åŒ–]
    D --> D2[æ€§èƒ½ä¼˜åŒ–]
    D --> D3[èµ„æºç®¡ç†]
    
    E --> E1[ç¤¾äº¤åˆ†äº«]
    E --> E2[æˆå°±ç³»ç»Ÿ]
    E --> E3[æ¯æ—¥æŒ‘æˆ˜]
```

---

## 1ï¸âƒ£ å­¦ä¹ ç³»ç»Ÿä¼˜åŒ–ï¼ˆä¼˜å…ˆçº§ï¼šğŸ”´ æé«˜ï¼‰

### 1.1 è‡ªé€‚åº”å­¦ä¹ è·¯å¾„ â­â­â­â­â­

**ç°çŠ¶é—®é¢˜**ï¼š
- è¯åº“æŒ‰å›ºå®šé¡ºåºè½®æ¢ï¼Œæ‰€æœ‰å­¦ç”ŸåŒä¸€è¿›åº¦
- æœªæ ¹æ®ç­”é¢˜æ•°æ®åŠ¨æ€è°ƒæ•´éš¾åº¦
- å­¦éœ¸æµªè´¹æ—¶é—´ï¼Œå­¦å›°ç”Ÿè·Ÿä¸ä¸Š

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

#### A. åŠ¨æ€éš¾åº¦åˆ†çº§ç³»ç»Ÿ
```javascript
// config/adaptive-learning.json (æ–°å¢é…ç½®æ–‡ä»¶)
{
  "difficultyLevels": {
    "beginner": {
      "wordFrequency": "top1000",
      "challengeInterval": 300,  // æ¯300åˆ†è§¦å‘ä¸€æ¬¡æŒ‘æˆ˜
      "questionTime": 20         // ç­”é¢˜æ—¶é—´20ç§’
    },
    "intermediate": {
      "wordFrequency": "top2000",
      "challengeInterval": 200,
      "questionTime": 15
    },
    "advanced": {
      "wordFrequency": "top3000+",
      "challengeInterval": 150,
      "questionTime": 12
    }
  },
  "adjustmentRules": {
    "promoteThreshold": 0.85,    // æ­£ç¡®ç‡>85%æ™‹çº§
    "demoteThreshold": 0.50,     // æ­£ç¡®ç‡<50%é™çº§
    "sampleSize": 20             // è¯„ä¼°æ ·æœ¬æ•°
  }
}
```

#### B. æ™ºèƒ½è¯æ±‡æ¨èå¼•æ“
```javascript
// src/modules/22-adaptive-vocab.js (æ–°å¢æ¨¡å—)
class AdaptiveVocabEngine {
  constructor(studentStats) {
    this.stats = studentStats;
    this.forgettingCurve = this.buildForgettingCurve();
  }
  
  // åŸºäºé—å¿˜æ›²çº¿ä¼˜å…ˆçº§æ’åº
  selectNextWord(vocabPool) {
    return vocabPool.map(word => ({
      word,
      priority: this.calculatePriority(word)
    }))
    .sort((a, b) => b.priority - a.priority)[0].word;
  }
  
  calculatePriority(word) {
    const wordStats = this.stats[word.id] || {
      lastReview: 0,
      errorRate: 0,
      reviewCount: 0
    };
    
    // ä¼˜å…ˆçº§ = é”™è¯¯ç‡æƒé‡ + æ—¶é—´æƒé‡ - ç†Ÿç»ƒåº¦æƒé‡
    const errorWeight = wordStats.errorRate * 0.4;
    const timeWeight = this.getTimeWeight(wordStats.lastReview) * 0.4;
    const masteryWeight = Math.min(wordStats.reviewCount / 10, 1) * 0.2;
    
    return errorWeight + timeWeight - masteryWeight;
  }
  
  getTimeWeight(lastReview) {
    const daysSince = (Date.now() - lastReview) / (1000 * 60 * 60 * 24);
    // 1å¤©æœªå¤ä¹ =0.2, 7å¤©=0.6, 14å¤©=1.0
    return Math.min(daysSince / 14, 1);
  }
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- å­¦ä¹ æ•ˆç‡æå‡ 30-40%
- å­¦ç”ŸæŒ«è´¥æ„Ÿé™ä½ 50%
- ä¸åŒæ°´å¹³å­¦ç”Ÿéƒ½èƒ½è·å¾—é€‚é…ä½“éªŒ

---

### 1.2 å­¦ä¹ æ•°æ®å¯è§†åŒ–ä»ªè¡¨ç›˜ â­â­â­â­â­

**ç°çŠ¶é—®é¢˜**ï¼š
- åªæœ‰åŸºç¡€ç»Ÿè®¡ï¼ˆç­”é¢˜æ¬¡æ•°ã€æ­£ç¡®ç‡ï¼‰
- å­¦ç”Ÿå’Œå®¶é•¿æ— æ³•çœ‹åˆ°å­¦ä¹ è¶‹åŠ¿
- ç¼ºå°‘æ¿€åŠ±æ€§çš„æ•°æ®å±•ç¤º

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

#### A. å­¦ä¹ è¿›åº¦ä»ªè¡¨ç›˜
```javascript
// æ–°å¢UIé¢æ¿ï¼šä¸ªäººèµ„æ–™ â†’ å­¦ä¹ ç»Ÿè®¡
const learningDashboard = {
  // 1. æ¯æ—¥å­¦ä¹ æ›²çº¿ï¼ˆæŠ˜çº¿å›¾ï¼‰
  dailyProgress: {
    dates: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
    newWords: [5, 8, 6, 10, 7, 12, 9],
    reviewWords: [15, 20, 18, 25, 22, 30, 28],
    accuracy: [0.75, 0.80, 0.78, 0.85, 0.82, 0.88, 0.90]
  },
  
  // 2. è¯æ±‡æŒæ¡åº¦çƒ­åŠ›å›¾
  vocabularyHeatmap: {
    categories: ['åŠ¨ç‰©', 'é£Ÿç‰©', 'é¢œè‰²', 'æ•°å­—', 'åŠ¨ä½œ', 'è‡ªç„¶'],
    mastery: [0.8, 0.9, 0.6, 0.7, 0.5, 0.85]  // 0-1æŒæ¡åº¦
  },
  
  // 3. å­¦ä¹ æ—¶é•¿ç»Ÿè®¡
  timeStats: {
    totalPlayTime: 3600,      // æ€»æ¸¸æˆæ—¶é•¿ï¼ˆç§’ï¼‰
    activeLearnTime: 1800,    // æœ‰æ•ˆå­¦ä¹ æ—¶é•¿ï¼ˆç§’ï¼‰
    efficiency: 0.5           // å­¦ä¹ æ•ˆç‡ = æœ‰æ•ˆæ—¶é•¿/æ€»æ—¶é•¿
  },
  
  // 4. è¿›æ­¥è¶‹åŠ¿å¯¹æ¯”
  weeklyComparison: {
    thisWeek: { words: 45, accuracy: 0.85 },
    lastWeek: { words: 38, accuracy: 0.78 },
    improvement: { words: '+18%', accuracy: '+9%' }
  }
};
```

#### B. å®ç°ç¤ºä¾‹ï¼ˆä½¿ç”¨Canvasç»˜åˆ¶ï¼‰
```javascript
// src/modules/23-learning-dashboard.js
class LearningDashboard {
  renderDailyProgress(canvas, data) {
    const ctx = canvas.getContext('2d');
    const width = canvas.width;
    const height = canvas.height;
    
    // ç»˜åˆ¶ç½‘æ ¼
    this.drawGrid(ctx, width, height);
    
    // ç»˜åˆ¶æŠ˜çº¿å›¾ï¼ˆæ­£ç¡®ç‡ï¼‰
    ctx.beginPath();
    ctx.strokeStyle = '#4CAF50';
    ctx.lineWidth = 3;
    
    data.accuracy.forEach((acc, i) => {
      const x = (width / 7) * i + 40;
      const y = height - (acc * height * 0.8) - 40;
      if (i === 0) ctx.moveTo(x, y);
      else ctx.lineTo(x, y);
    });
    ctx.stroke();
    
    // ç»˜åˆ¶æ•°æ®ç‚¹
    data.accuracy.forEach((acc, i) => {
      const x = (width / 7) * i + 40;
      const y = height - (acc * height * 0.8) - 40;
      
      ctx.beginPath();
      ctx.arc(x, y, 5, 0, Math.PI * 2);
      ctx.fillStyle = '#4CAF50';
      ctx.fill();
      
      // æ˜¾ç¤ºç™¾åˆ†æ¯”
      ctx.fillStyle = '#333';
      ctx.font = '12px Arial';
      ctx.textAlign = 'center';
      ctx.fillText(`${Math.round(acc * 100)}%`, x, y - 15);
    });
  }
  
  renderVocabularyHeatmap(canvas, data) {
    const ctx = canvas.getContext('2d');
    const cellWidth = canvas.width / data.categories.length;
    const cellHeight = 60;
    
    data.categories.forEach((category, i) => {
      const mastery = data.mastery[i];
      const x = i * cellWidth;
      
      // æ ¹æ®æŒæ¡åº¦è®¾ç½®é¢œè‰²
      const color = this.getMasteryColor(mastery);
      ctx.fillStyle = color;
      ctx.fillRect(x, 20, cellWidth - 5, cellHeight);
      
      // æ˜¾ç¤ºç±»åˆ«åç§°
      ctx.fillStyle = '#fff';
      ctx.font = 'bold 14px Arial';
      ctx.textAlign = 'center';
      ctx.fillText(category, x + cellWidth / 2, 50);
      
      // æ˜¾ç¤ºæŒæ¡åº¦ç™¾åˆ†æ¯”
      ctx.fillText(`${Math.round(mastery * 100)}%`, x + cellWidth / 2, 70);
    });
  }
  
  getMasteryColor(mastery) {
    if (mastery >= 0.8) return '#4CAF50';  // ç»¿è‰²-å·²æŒæ¡
    if (mastery >= 0.5) return '#FFC107';  // é»„è‰²-åŸºæœ¬æŒæ¡
    return '#F44336';                       // çº¢è‰²-éœ€åŠ å¼º
  }
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- å­¦ä¹ åŠ¨æœºæå‡ 40%ï¼ˆå¯è§†åŒ–è¿›æ­¥ï¼‰
- å®¶é•¿æ»¡æ„åº¦æå‡ 60%ï¼ˆæ¸…æ™°çš„å­¦ä¹ æŠ¥å‘Šï¼‰
- å­¦ç”Ÿè‡ªæˆ‘è®¤çŸ¥èƒ½åŠ›æå‡

---

### 1.3 ç§‘å­¦é—´éš”é‡å¤ç®—æ³•ï¼ˆSuperMemo SM-2æ”¹è¿›ç‰ˆï¼‰â­â­â­â­

**ç°çŠ¶é—®é¢˜**ï¼š
- ç¾¤ç³»å¤ä¹ æœ‰åŸºç¡€å®ç°ï¼Œä½†ç®—æ³•è¿‡äºç®€å•
- æœªå……åˆ†åˆ©ç”¨è®°å¿†æ›²çº¿
- å¤ä¹ æ—¶æœºä¸å¤Ÿç²¾å‡†

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

```javascript
// src/modules/24-spaced-repetition.js
class SpacedRepetitionSystem {
  constructor() {
    this.ease_factor_default = 2.5;
    this.interval_multiplier = 1.0;
  }
  
  /**
   * SM-2ç®—æ³•æ ¸å¿ƒé€»è¾‘
   * @param {Object} word - å•è¯å¯¹è±¡
   * @param {Number} quality - ç­”é¢˜è´¨é‡ (0-5)
   *   5 = å®Œç¾è®°å¿†ï¼Œç«‹å³å›å¿†
   *   4 = æ­£ç¡®ä½†çŠ¹è±«
   *   3 = æ­£ç¡®ä½†è´¹åŠ›
   *   2 = é”™è¯¯ä½†å°è±¡å­˜åœ¨
   *   1 = é”™è¯¯ä½†æœ‰ç‚¹ç†Ÿæ‚‰
   *   0 = å®Œå…¨ä¸è®°å¾—
   */
  calculateNextReview(word, quality) {
    let { easeFactor = 2.5, interval = 0, repetitions = 0 } = word.srsData || {};
    
    // ç­”å¯¹ï¼ˆquality >= 3ï¼‰
    if (quality >= 3) {
      if (repetitions === 0) {
        interval = 1;  // é¦–æ¬¡ï¼š1å¤©åå¤ä¹ 
      } else if (repetitions === 1) {
        interval = 6;  // ç¬¬äºŒæ¬¡ï¼š6å¤©åå¤ä¹ 
      } else {
        interval = Math.round(interval * easeFactor);
      }
      repetitions++;
    } 
    // ç­”é”™ï¼ˆquality < 3ï¼‰
    else {
      repetitions = 0;
      interval = 1;  // é‡ç½®ä¸º1å¤©åå¤ä¹ 
    }
    
    // è°ƒæ•´éš¾åº¦å› å­
    easeFactor = easeFactor + (0.1 - (5 - quality) * (0.08 + (5 - quality) * 0.02));
    easeFactor = Math.max(1.3, easeFactor);  // æœ€å°éš¾åº¦å› å­1.3
    
    const nextReviewDate = Date.now() + interval * 24 * 60 * 60 * 1000;
    
    return {
      srsData: {
        nextReview: nextReviewDate,
        easeFactor: easeFactor,
        interval: interval,
        repetitions: repetitions
      },
      // æ¨èå¤ä¹ æ—¶é—´çš„å¯è¯»æ ¼å¼
      nextReviewHuman: this.formatReviewTime(interval)
    };
  }
  
  formatReviewTime(days) {
    if (days === 0) return 'ç«‹å³';
    if (days === 1) return 'æ˜å¤©';
    if (days < 7) return `${days}å¤©å`;
    if (days < 30) return `${Math.round(days / 7)}å‘¨å`;
    return `${Math.round(days / 30)}æœˆå`;
  }
  
  // è·å–ä»Šæ—¥åº”å¤ä¹ çš„å•è¯åˆ—è¡¨
  getDueWords(allWords) {
    const now = Date.now();
    return allWords
      .filter(word => {
        const nextReview = word.srsData?.nextReview || 0;
        return nextReview <= now;
      })
      .sort((a, b) => {
        // ä¼˜å…ˆå¤ä¹ é€¾æœŸæœ€ä¹…çš„
        return (a.srsData?.nextReview || 0) - (b.srsData?.nextReview || 0);
      });
  }
  
  // ç­”é¢˜è´¨é‡è¯„ä¼°ï¼ˆåŸºäºç­”é¢˜æ—¶é—´å’Œæ˜¯å¦æ­£ç¡®ï¼‰
  assessQuality(isCorrect, responseTime, maxTime) {
    if (!isCorrect) {
      // ç­”é”™æ ¹æ®æ—¶é—´åˆ¤æ–­ç†Ÿæ‚‰åº¦
      if (responseTime < maxTime * 0.3) return 1;  // å¿«é€Ÿç­”é”™=æœ‰å°è±¡
      return 0;  // æ…¢é€Ÿç­”é”™=å®Œå…¨ä¸ä¼š
    }
    
    // ç­”å¯¹æ ¹æ®æ—¶é—´åˆ¤æ–­ç†Ÿç»ƒåº¦
    if (responseTime < maxTime * 0.3) return 5;  // ç§’ç­”=å®Œç¾è®°å¿†
    if (responseTime < maxTime * 0.6) return 4;  // è¾ƒå¿«=ç†Ÿç»ƒ
    return 3;  // è¾ƒæ…¢=è´¹åŠ›ä½†æ­£ç¡®
  }
}
```

**æ•´åˆåˆ°ç°æœ‰ç³»ç»Ÿ**ï¼š

```javascript
// åœ¨ 12-challenges.js ä¸­æ•´åˆ
function handleChallengeAnswer(answer, correctAnswer, responseTime) {
  const isCorrect = answer === correctAnswer;
  const quality = srsSystem.assessQuality(isCorrect, responseTime, 15000);
  
  // æ›´æ–°å•è¯çš„SRSæ•°æ®
  const wordId = currentChallenge.word.id;
  const currentWordData = progress.vocab[wordId] || {};
  const updatedData = srsSystem.calculateNextReview(currentWordData, quality);
  
  progress.vocab[wordId] = {
    ...currentWordData,
    ...updatedData.srsData,
    lastReview: Date.now(),
    reviewCount: (currentWordData.reviewCount || 0) + 1
  };
  
  // æ˜¾ç¤ºä¸‹æ¬¡å¤ä¹ æ—¶é—´æç¤º
  if (isCorrect) {
    showFloatingText(`å¤ªæ£’äº†ï¼${updatedData.nextReviewHuman}å†å¤ä¹ `);
  }
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- è®°å¿†ç•™å­˜ç‡æå‡ 50%
- å¤ä¹ æ•ˆç‡æå‡ 40%ï¼ˆç²¾å‡†æ—¶æœºï¼‰
- é•¿æœŸå­¦ä¹ æ•ˆæœæ˜¾è‘—æ”¹å–„

---

### 1.4 è¯­å¢ƒå­¦ä¹ å¢å¼º â­â­â­

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼šåœ¨è¯å¡å’ŒæŒ‘æˆ˜ä¸­å¢åŠ ä¾‹å¥

```javascript
// words/vocabs/*.json æ•°æ®ç»“æ„æ‰©å±•
{
  "word": "apple",
  "translation": "è‹¹æœ",
  "image": "apple.png",
  "sentence": "I eat an apple every day.",        // æ–°å¢
  "sentenceCN": "æˆ‘æ¯å¤©åƒä¸€ä¸ªè‹¹æœã€‚",             // æ–°å¢
  "synonyms": ["fruit"],                          // æ–°å¢
  "difficulty": "beginner"                        // æ–°å¢
}
```

**å±•ç¤ºé€»è¾‘**ï¼š
- è¯å¡æ‹¾å–æ—¶ï¼šæ˜¾ç¤ºä¾‹å¥ï¼ˆå¯é€‰å¼€å…³ï¼‰
- æŒ‘æˆ˜ç­”å¯¹åï¼šå¥–åŠ±æ˜¾ç¤ºä¾‹å¥
- å•è¯æœ¬å¤ä¹ ï¼šå¯ç‚¹å‡»æŸ¥çœ‹ä¾‹å¥

---

### 1.5 æ‹¼å†™ç»ƒä¹ å¼ºåŒ– â­â­â­

**ç°çŠ¶é—®é¢˜**ï¼šfill_blank åªå¡«å•ä¸ªå­—æ¯ï¼Œè®­ç»ƒæ•ˆæœæœ‰é™

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

```javascript
// æ‹¼å†™æŒ‘æˆ˜å˜ä½“
const spellingChallenges = {
  // ç°æœ‰æ¨¡å¼
  singleLetter: {
    type: 'fill_blank',
    word: 'a_ple',
    answer: 'p'
  },
  
  // æ–°å¢ï¼šå¤šå­—æ¯å¡«ç©º
  multipleLetter: {
    type: 'fill_blank_multi',
    word: 'el_ph_nt',
    answer: 'ea'  // éœ€è¦å¡« eå’Œa
  },
  
  // æ–°å¢ï¼šå®Œæ•´æ‹¼å†™
  fullWord: {
    type: 'spell_complete',
    audio: 'apple.mp3',  // æ’­æ”¾å‘éŸ³
    hint: 'ğŸ ä¸€ç§æ°´æœ',
    answer: 'apple'
  },
  
  // æ–°å¢ï¼šå­—æ¯é‡æ’
  unscramble: {
    type: 'unscramble',
    scrambled: 'plepa',
    answer: 'apple'
  }
};
```

---

## 2ï¸âƒ£ æ¸¸æˆæ€§ä¼˜åŒ–ï¼ˆä¼˜å…ˆçº§ï¼šğŸ”´ é«˜ï¼‰

### 2.1 éš¾åº¦æ›²çº¿å¹³æ»‘åŒ– â­â­â­â­â­

**ç°çŠ¶é—®é¢˜**ï¼š
- éš¾åº¦å±‚çº§æŒ‰å›ºå®šåˆ†æ•°è·³è·ƒï¼ˆ500/1500/3000/5000ï¼‰
- ç©å®¶åœ¨éš¾åº¦åˆ‡æ¢ç‚¹å®¹æ˜“é­é‡æŒ«è´¥
- DDAç³»ç»Ÿå­˜åœ¨ä½†è°ƒæ•´å¹…åº¦æœ‰é™

**ä¼˜åŒ–æ–¹æ¡ˆAï¼šå¹³æ»‘éš¾åº¦å‡½æ•°**

```javascript
// src/modules/05-difficulty.js é‡æ„
class SmoothDifficultySystem {
  constructor() {
    this.baseMultiplier = 1.0;
    this.maxMultiplier = 1.8;
    this.targetScore = 2500;  // ä¸­ç­‰éš¾åº¦åˆ†æ•°ç‚¹
    this.steepness = 0.0008;  // æ›²çº¿é™¡å³­åº¦
  }
  
  // ä½¿ç”¨Sigmoidå‡½æ•°å®ç°å¹³æ»‘è¿‡æ¸¡
  calculateMultiplier(score) {
    const x = score - this.targetScore;
    const sigmoid = 1 / (1 + Math.exp(-this.steepness * x));
    
    return this.baseMultiplier + 
           (this.maxMultiplier - this.baseMultiplier) * sigmoid;
  }
  
  // åº”ç”¨åˆ°å„é¡¹æ•°å€¼
  applyDifficulty(score) {
    const multiplier = this.calculateMultiplier(score);
    
    return {
      enemyDamage: 1.0 * multiplier,
      enemyHealth: 1.0 * multiplier,
      enemySpawnRate: 0.45 * (0.5 + multiplier * 0.5),
      chestRarity: 1.0 / multiplier,  // éš¾åº¦è¶Šé«˜ç®±å­è¶Šå·®
      scoreBonus: multiplier  // éš¾åº¦è¶Šé«˜åˆ†æ•°åŠ æˆè¶Šå¤š
    };
  }
}
```

**ä¼˜åŒ–æ–¹æ¡ˆBï¼šè‡ªé€‚åº”éš¾åº¦å¸¦**

```javascript
// æ ¹æ®ç©å®¶è¡¨ç°åŠ¨æ€è°ƒæ•´éš¾åº¦ç›®æ ‡
class AdaptiveDifficulty {
  constructor() {
    this.performanceWindow = [];  // æœ€è¿‘10æ¬¡æˆ˜æ–—è¡¨ç°
    this.targetWinRate = 0.65;    // ç›®æ ‡èƒœç‡65%
  }
  
  recordPerformance(survived, damageDealt, damageTaken) {
    const performance = {
      survived,
      efficiency: damageDealt / Math.max(damageTaken, 1),
      timestamp: Date.now()
    };
    
    this.performanceWindow.push(performance);
    if (this.performanceWindow.length > 10) {
      this.performanceWindow.shift();
    }
  }
  
  getAdjustment() {
    if (this.performanceWindow.length < 5) return 1.0;
    
    const winRate = this.performanceWindow.filter(p => p.survived).length / 
                    this.performanceWindow.length;
    
    const avgEfficiency = this.performanceWindow.reduce((sum, p) => 
      sum + p.efficiency, 0) / this.performanceWindow.length;
    
    // è¡¨ç°å¤ªå¥½ï¼šå¢åŠ éš¾åº¦
    if (winRate > 0.8 && avgEfficiency > 3.0) {
      return 1.15;
    }
    // è¡¨ç°å¤ªå·®ï¼šé™ä½éš¾åº¦
    else if (winRate < 0.4 || avgEfficiency < 1.0) {
      return 0.85;
    }
    
    return 1.0;
  }
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- æŒ«è´¥æ„Ÿé™ä½ 60%
- æ¸¸æˆæµç•…åº¦æå‡
- ç•™å­˜ç‡æå‡ 30%

---

### 2.2 æˆ˜æ–—ç­–ç•¥æ·±åº¦æå‡ â­â­â­â­

**ç°çŠ¶é—®é¢˜**ï¼š
- æˆ˜æ–—ä»¥"è·³è·ƒ+æ”»å‡»"ä¸ºä¸»ï¼Œç­–ç•¥å•ä¸€
- æ­¦å™¨åˆ‡æ¢åŠ¨æœºä¸è¶³
- Bossæˆ˜è™½æœ‰å¤šé˜¶æ®µä½†æ‰‹æ„Ÿé‡å¤

**ä¼˜åŒ–æ–¹æ¡ˆAï¼šæ­¦å™¨å…‹åˆ¶ç³»ç»Ÿ**

```javascript
// config/weapon-system.json (æ–°å¢)
{
  "weaponTypes": {
    "sword": {
      "effectiveAgainst": ["zombie", "skeleton", "piglin"],
      "damageBonus": 1.3,
      "specialEffect": "cleave"  // æ¨ªæ‰«æ”»å‡»
    },
    "axe": {
      "effectiveAgainst": ["spider", "creeper"],
      "damageBonus": 1.5,
      "specialEffect": "armor_break"  // ç ´ç”²
    },
    "pickaxe": {
      "effectiveAgainst": ["magma_cube", "sculk_worm"],
      "damageBonus": 1.4,
      "specialEffect": "stun"  // å‡»æ™•çŸ¿ç‰©ç±»æ•Œäºº
    },
    "bow": {
      "effectiveAgainst": ["phantom", "vex", "ghast"],
      "damageBonus": 1.6,
      "specialEffect": "pierce"  // ç©¿é€é£è¡Œæ•Œäºº
    }
  }
}
```

**ä¼˜åŒ–æ–¹æ¡ˆBï¼šè¿å‡»ç³»ç»Ÿ**

```javascript
// å®ç°è¿å‡»æœºåˆ¶
class ComboSystem {
  constructor() {
    this.comboCount = 0;
    this.lastHitTime = 0;
    this.comboWindow = 2000;  // 2ç§’å†…ç»§ç»­æ”»å‡»ç»´æŒè¿å‡»
  }
  
  registerHit(enemyType, weaponType) {
    const now = Date.now();
    
    // æ£€æŸ¥è¿å‡»æ˜¯å¦ä¸­æ–­
    if (now - this.lastHitTime > this.comboWindow) {
      this.comboCount = 0;
    }
    
    this.comboCount++;
    this.lastHitTime = now;
    
    // è¿å‡»åŠ æˆ
    const comboDamageBonus = Math.min(1 + (this.comboCount * 0.1), 2.0);
    
    // ç‰¹æ®Šè¿å‡»æŠ€ï¼ˆæ¯5è¿å‡»è§¦å‘ï¼‰
    if (this.comboCount % 5 === 0) {
      this.triggerComboSkill(weaponType);
    }
    
    return {
      count: this.comboCount,
      damageMultiplier: comboDamageBonus,
      displayText: this.comboCount >= 3 ? `${this.comboCount}è¿å‡»ï¼` : ''
    };
  }
  
  triggerComboSkill(weaponType) {
    const skills = {
      sword: 'æ—‹é£æ–©ï¼',      // AOEä¼¤å®³
      axe: 'åœ°è£‚å‡»ï¼',        // èŒƒå›´çœ©æ™•
      pickaxe: 'éœ‡åœ°æ³¢ï¼',    // å‡»é£æ•Œäºº
      bow: 'çˆ†è£‚ç®­ï¼'         // èŒƒå›´çˆ†ç‚¸ç®­
    };
    
    showFloatingText(skills[weaponType] || 'è¿å‡»æŠ€èƒ½ï¼', '#FFD700');
    // å®é™…æŠ€èƒ½æ•ˆæœå®ç°...
  }
}
```

**ä¼˜åŒ–æ–¹æ¡ˆCï¼šæ•Œäººå¼±ç‚¹ç³»ç»Ÿ**

```javascript
// ä¸ºæ•Œäººå¢åŠ å¼±ç‚¹æœºåˆ¶
const enemyWeakpoints = {
  creeper: {
    weakpoint: 'head',        // å¤´éƒ¨å¼±ç‚¹
    weakpointMultiplier: 2.0, // å¼±ç‚¹ä¼¤å®³Ã—2
    stunOnWeakpoint: true     // å‡»ä¸­å¼±ç‚¹ä¼šçœ©æ™•
  },
  skeleton: {
    weakpoint: 'bow',         // è¿œç¨‹æ•Œäººè¢«è¿‘æˆ˜å…‹åˆ¶
    disarmChance: 0.3         // 30%å‡ ç‡æ‰“æ‰å¼“
  },
  ghast: {
    weakpoint: 'fireball',    // åå¼¹ç«çƒæ˜¯å¼±ç‚¹
    reflectDamage: 3.0
  }
};
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- æˆ˜æ–—ç­–ç•¥æ·±åº¦æå‡ 200%
- æ­¦å™¨åˆ‡æ¢é¢‘ç‡æå‡ 150%
- æˆ˜æ–—è¶£å‘³æ€§å¤§å¹…æå‡

---

### 2.3 ç¾¤ç³»å·®å¼‚åŒ–å¼ºåŒ– â­â­â­â­

**ç°çŠ¶é—®é¢˜**ï¼š
- 12ä¸ªç¾¤ç³»ä¸»è¦æ˜¯è§†è§‰å·®å¼‚
- ç‰©ç†ä¿®æ­£æœ‰é™ï¼ˆé€Ÿåº¦Ã—1.2ã€é‡åŠ›è°ƒæ•´ç­‰ï¼‰
- ç¼ºå°‘ç¾¤ç³»ä¸“å±æœºåˆ¶

**ä¼˜åŒ–æ–¹æ¡ˆAï¼šç¾¤ç³»ç‰¹è‰²ç©æ³•**

| ç¾¤ç³» | ç°æœ‰æœºåˆ¶ | æ–°å¢ç‰¹è‰²ç©æ³• |
|------|----------|--------------|
| æµ·æ´‹ | æ¸¸æ³³å‡é€Ÿ | **æ½®æ±ç³»ç»Ÿ**ï¼šæ°´ä½å‘¨æœŸæ€§ä¸Šæ¶¨ä¸‹é™ï¼Œå½±å“å¹³å°å¯è¾¾æ€§ |
| ç«å±± | æŒç»­çƒ­ä¼¤å®³ | **å–·å‘é¢„è­¦**ï¼šå®šæœŸå–·å‘å²©æµ†æŸ±ï¼Œéœ€è¦æ‰¾æ©ä½“èº²é¿ |
| æœ«åœ° | ä½é‡åŠ› | **ä¼ é€é—¨ç½‘ç»œ**ï¼šå¤šä¸ªä¼ é€é—¨å¯å¿«é€Ÿç§»åŠ¨ï¼Œä½†éšæœºæ€§å¼º |
| æ·±æš—ä¹‹åŸŸ | é»‘æš—è§†é‡ | **å™ªéŸ³ç³»ç»Ÿ**ï¼šè·³è·ƒå’Œæ”»å‡»äº§ç”Ÿå™ªéŸ³ï¼Œå¼•æ¥å¹½åŒ¿è •è™« |
| å¤©ç©ºä¹‹åŸ | ä½é‡åŠ›é«˜è·³ | **å è½æƒ©ç½š**ï¼šæ‰ä¸‹å¹³å°ä¼šæŸå¤±å¤§é‡åˆ†æ•°ï¼Œå¢åŠ ç´§å¼ æ„Ÿ |
| é›ªåœ° | å†°é¢æ»‘è¡Œ | **é›ªå´©æœºåˆ¶**ï¼šè·³è·ƒå¯èƒ½è§¦å‘é›ªå´©ï¼Œéœ€å¿«é€Ÿèº²é¿ |

**ä¼˜åŒ–æ–¹æ¡ˆBï¼šç¾¤ç³»èµ„æºç‰¹åŒ–**

```javascript
// config/biome-resources.json
{
  "mountain": {
    "exclusiveResources": ["diamond_ore", "emerald_ore"],
    "chestBonusRarity": 1.3,  // å±±åœ°å®ç®±ç¨€æœ‰åº¦+30%
    "learningBonus": {
      "theme": "mining",  // é‡‡çŸ¿ä¸»é¢˜è¯æ±‡
      "scoreMultiplier": 1.2
    }
  },
  "ocean": {
    "exclusiveResources": ["coral", "pearl", "treasure_map"],
    "oxygenMechanic": true,  // éœ€è¦æ‰¾æ°”æ³¡è¡¥å……æ°§æ°”
    "learningBonus": {
      "theme": "sea_life",
      "scoreMultiplier": 1.15
    }
  }
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- ç¾¤ç³»è¾¨è¯†åº¦æå‡ 100%
- é‡å¤å¯ç©æ€§æå‡ 80%
- ç©å®¶æœŸå¾…æ„Ÿå¢å¼º

---

### 2.4 Bossæˆ˜æ‰‹æ„Ÿä¼˜åŒ– â­â­â­

**ç°çŠ¶é—®é¢˜**ï¼š
- Bossæˆ˜è™½æœ‰é˜¶æ®µè®¾è®¡ï¼Œä½†åé¦ˆä¸å¤Ÿæ˜ç¡®
- ç¼ºå°‘Bossç‹¬ç‰¹å‡»è´¥æ–¹å¼

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

```javascript
// ä¸ºæ¯ä¸ªBosså¢åŠ "ç»ˆç»“æŠ€"æœºåˆ¶
const bossFinishers = {
  wither: {
    finisherCondition: 'hp < 20%',
    finisherType: 'quicktime_event',  // QTEç»ˆç»“
    instruction: 'è¿ç»­æŒ‰Jé”®å¿«é€Ÿæ”»å‡»ï¼',
    damageMultiplier: 3.0
  },
  ghast: {
    finisherCondition: 'reflected_fireballs >= 5',
    finisherType: 'final_reflect',
    instruction: 'åå¼¹æœ€åä¸€å‘ç«çƒå‡»è´¥å®ƒï¼'
  },
  blaze: {
    finisherCondition: 'extinguished',  // ç”¨æ°´ç“¶æµ‡ç­
    finisherType: 'item_use',
    requiredItem: 'water_bottle'
  }
};
```

---

## 3ï¸âƒ£ æŠ€æœ¯æ¶æ„ä¼˜åŒ–ï¼ˆä¼˜å…ˆçº§ï¼šğŸŸ¡ ä¸­ï¼‰

### 3.1 ä»£ç æ¨¡å—åŒ–é‡æ„ â­â­â­â­

**ç°çŠ¶é—®é¢˜**ï¼š
- `src/main.js` å•æ–‡ä»¶6000è¡Œï¼Œéš¾ä»¥ç»´æŠ¤
- è™½æœ‰28ä¸ªæ¨¡å—æ–‡ä»¶ï¼Œä½†æœªå®Œå…¨æ¨¡å—åŒ–
- ç¼ºå°‘TypeScriptç±»å‹çº¦æŸ

**ä¼˜åŒ–æ–¹æ¡ˆAï¼šå®Œå…¨æ¨¡å—åŒ–**

```javascript
// å½“å‰ç»“æ„ï¼ˆéƒ¨åˆ†æ¨¡å—åŒ–ï¼‰
// Game.html ç›´æ¥å¼•å…¥ main.jsï¼ˆ6000è¡Œï¼‰

// ä¼˜åŒ–åç»“æ„ï¼ˆå®Œå…¨æ¨¡å—åŒ–ï¼‰
// Game.html åªå¼•å…¥ bootstrap.js
// bootstrap.js åŠ¨æ€åŠ è½½å„æ¨¡å—

// src/bootstrap.js (ä¼˜åŒ–ç‰ˆ)
const moduleLoadOrder = [
  'config',
  'utils',
  'audio',
  'storage',
  'weapons',
  'difficulty',
  'biome',
  'viewport',
  'account',
  'vocab',
  'ui',
  'challenges',
  'entities-base',
  'entities-combat',
  'game-loop',
  'renderer-main'
  // ... å…¶ä»–æ¨¡å—
];

async function loadModules() {
  for (const moduleName of moduleLoadOrder) {
    try {
      await import(`./modules/${moduleName}.js`);
      console.log(`âœ“ Loaded: ${moduleName}`);
    } catch (err) {
      console.error(`âœ— Failed to load: ${moduleName}`, err);
      throw err;
    }
  }
}

loadModules().then(() => {
  initGame();
}).catch(err => {
  showError('æ¸¸æˆåŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢');
});
```

**ä¼˜åŒ–æ–¹æ¡ˆBï¼šå¼•å…¥æ„å»ºå·¥å…·**

```javascript
// package.json æ–°å¢è„šæœ¬
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "build:single": "node tools/build-single-file.js"
  },
  "devDependencies": {
    "vite": "^5.0.0",
    "@rollup/plugin-terser": "^0.4.4"
  }
}

// vite.config.js
import { defineConfig } from 'vite';
import { terser } from '@rollup/plugin-terser';

export default defineConfig({
  build: {
    rollupOptions: {
      input: 'src/bootstrap.js',
      output: {
        entryFileNames: 'game.min.js',
        format: 'iife'
      },
      plugins: [
        terser({
          compress: {
            drop_console: true,  // ç”Ÿäº§ç¯å¢ƒç§»é™¤console
            pure_funcs: ['console.log']
          }
        })
      ]
    }
  }
});
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- å¼€å‘æ•ˆç‡æå‡ 50%
- ä»£ç å¯ç»´æŠ¤æ€§æå‡ 100%
- æ„å»ºäº§ç‰©ä½“ç§¯å‡å°‘ 30%

---

### 3.2 æ€§èƒ½ä¼˜åŒ– â­â­â­â­

**ä¼˜åŒ–æ–¹æ¡ˆAï¼šCanvasåˆ†å±‚æ¸²æŸ“**

```javascript
// å½“å‰ï¼šæ‰€æœ‰å†…å®¹åœ¨åŒä¸€Canvasä¸Šç»˜åˆ¶
// ä¼˜åŒ–ï¼šä½¿ç”¨å¤šå±‚Canvasï¼Œå‡å°‘é‡ç»˜

class LayeredRenderer {
  constructor() {
    this.layers = {
      background: this.createCanvas('background'),  // é™æ€èƒŒæ™¯
      terrain: this.createCanvas('terrain'),        // åœ°å½¢ï¼ˆå˜åŒ–å°‘ï¼‰
      entities: this.createCanvas('entities'),      // å®ä½“ï¼ˆé¢‘ç¹å˜åŒ–ï¼‰
      effects: this.createCanvas('effects'),        // ç²’å­æ•ˆæœ
      ui: this.createCanvas('ui')                   // UIå±‚
    };
    
    this.dirtyFlags = {
      background: true,
      terrain: true,
      entities: true,
      effects: true,
      ui: true
    };
  }
  
  createCanvas(id) {
    const canvas = document.createElement('canvas');
    canvas.id = id;
    canvas.width = 800;
    canvas.height = 600;
    canvas.style.position = 'absolute';
    canvas.style.zIndex = this.getZIndex(id);
    document.getElementById('game-container').appendChild(canvas);
    return canvas;
  }
  
  render(deltaTime) {
    // åªé‡ç»˜æ ‡è®°ä¸ºdirtyçš„å±‚
    if (this.dirtyFlags.background) {
      this.renderBackground();
      this.dirtyFlags.background = false;
    }
    
    if (this.dirtyFlags.terrain) {
      this.renderTerrain();
      this.dirtyFlags.terrain = false;
    }
    
    // å®ä½“å’Œæ•ˆæœå±‚æ¯å¸§é‡ç»˜
    this.renderEntities();
    this.renderEffects();
    this.renderUI();
  }
}
```

**ä¼˜åŒ–æ–¹æ¡ˆBï¼šå¯¹è±¡æ± **

```javascript
// é¿å…é¢‘ç¹åˆ›å»ºé”€æ¯å¯¹è±¡ï¼Œä½¿ç”¨å¯¹è±¡æ± å¤ç”¨

class ObjectPool {
  constructor(objectClass, initialSize = 50) {
    this.objectClass = objectClass;
    this.pool = [];
    this.active = [];
    
    // é¢„åˆ›å»ºå¯¹è±¡
    for (let i = 0; i < initialSize; i++) {
      this.pool.push(new objectClass());
    }
  }
  
  acquire(...args) {
    let obj;
    if (this.pool.length > 0) {
      obj = this.pool.pop();
      obj.reset?.(...args);  // é‡ç½®å¯¹è±¡çŠ¶æ€
    } else {
      obj = new this.objectClass(...args);
    }
    this.active.push(obj);
    return obj;
  }
  
  release(obj) {
    const index = this.active.indexOf(obj);
    if (index !== -1) {
      this.active.splice(index, 1);
      this.pool.push(obj);
    }
  }
  
  releaseAll() {
    this.pool.push(...this.active);
    this.active = [];
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const particlePool = new ObjectPool(Particle, 100);

function createExplosion(x, y) {
  for (let i = 0; i < 20; i++) {
    const particle = particlePool.acquire(x, y, 'explosion');
    // ä½¿ç”¨ç²’å­...
    
    // ç²’å­ç”Ÿå‘½å‘¨æœŸç»“æŸåå›æ”¶
    setTimeout(() => particlePool.release(particle), 1000);
  }
}
```

**ä¼˜åŒ–æ–¹æ¡ˆCï¼šèµ„æºæ‡’åŠ è½½**

```javascript
// å›¾ç‰‡èµ„æºæŒ‰éœ€åŠ è½½
class ResourceManager {
  constructor() {
    this.loadedAssets = new Map();
    this.loading = new Map();
  }
  
  async loadImage(src) {
    // å·²åŠ è½½ç›´æ¥è¿”å›
    if (this.loadedAssets.has(src)) {
      return this.loadedAssets.get(src);
    }
    
    // æ­£åœ¨åŠ è½½åˆ™ç­‰å¾…
    if (this.loading.has(src)) {
      return this.loading.get(src);
    }
    
    // å¼€å§‹åŠ è½½
    const promise = new Promise((resolve, reject) => {
      const img = new Image();
      img.onload = () => {
        this.loadedAssets.set(src, img);
        this.loading.delete(src);
        resolve(img);
      };
      img.onerror = reject;
      img.src = src;
    });
    
    this.loading.set(src, promise);
    return promise;
  }
  
  // é¢„åŠ è½½å…³é”®èµ„æº
  async preloadCritical() {
    const critical = [
      'player.png',
      'common_enemies.png',
      'basic_items.png'
    ];
    
    await Promise.all(critical.map(src => this.loadImage(src)));
  }
  
  // å¸è½½ä¸éœ€è¦çš„èµ„æºï¼ˆåˆ‡æ¢ç¾¤ç³»æ—¶ï¼‰
  unloadBiome(biomeName) {
    for (const [key, value] of this.loadedAssets.entries()) {
      if (key.includes(biomeName)) {
        this.loadedAssets.delete(key);
      }
    }
  }
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- å¸§ç‡æå‡ 40%ï¼ˆ60fps â†’ ç¨³å®š60fpsï¼‰
- å†…å­˜å ç”¨é™ä½ 30%
- åŠ è½½é€Ÿåº¦æå‡ 50%

---

### 3.3 ç§»åŠ¨ç«¯ä½“éªŒä¼˜åŒ– â­â­â­

**ä¼˜åŒ–æ–¹æ¡ˆAï¼šè§¦æ§ä¼˜åŒ–**

```javascript
// ä¼˜åŒ–è§¦æ§æŒ‰é’®å“åº”èŒƒå›´
class MobileControls {
  constructor() {
    this.touchZones = {
      left: { x: 0, y: 400, width: 150, height: 200 },
      right: { x: 150, y: 400, width: 150, height: 200 },
      jump: { x: 600, y: 400, width: 100, height: 100 },
      attack: { x: 700, y: 400, width: 100, height: 100 }
    };
    
    // è§¦æ§æ­»åŒºï¼ˆé¿å…è¯¯è§¦ï¼‰
    this.deadZone = 5;
  }
  
  handleTouch(e) {
    e.preventDefault();  // é˜»æ­¢é»˜è®¤æ»šåŠ¨
    
    const touches = Array.from(e.touches);
    const actions = new Set();
    
    touches.forEach(touch => {
      const zone = this.getTouchZone(touch.clientX, touch.clientY);
      if (zone) actions.add(zone);
    });
    
    // è§¦è§‰åé¦ˆ
    if (navigator.vibrate && actions.size > 0) {
      navigator.vibrate(10);
    }
    
    return actions;
  }
  
  getTouchZone(x, y) {
    for (const [name, zone] of Object.entries(this.touchZones)) {
      if (this.pointInZone(x, y, zone)) {
        return name;
      }
    }
    return null;
  }
}
```

**ä¼˜åŒ–æ–¹æ¡ˆBï¼šè‡ªé€‚åº”UIç¼©æ”¾**

```javascript
// æ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´UI
class ResponsiveUI {
  constructor() {
    this.baseWidth = 800;
    this.baseHeight = 600;
    this.updateScale();
    
    window.addEventListener('resize', () => this.updateScale());
  }
  
  updateScale() {
    const scaleX = window.innerWidth / this.baseWidth;
    const scaleY = window.innerHeight / this.baseHeight;
    this.scale = Math.min(scaleX, scaleY);
    
    // åº”ç”¨ç¼©æ”¾
    document.getElementById('game-container').style.transform = 
      `scale(${this.scale})`;
    
    // è°ƒæ•´è§¦æ§æŒ‰é’®å¤§å°ï¼ˆç§»åŠ¨ç«¯æ”¾å¤§ï¼‰
    if (this.isMobile()) {
      this.scaleTouchButtons(1.3);
    }
  }
  
  isMobile() {
    return /Android|iPhone|iPad/i.test(navigator.userAgent);
  }
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- ç§»åŠ¨ç«¯æ“æ§ç²¾ç¡®åº¦æå‡ 50%
- ç§»åŠ¨ç«¯æµå¤±ç‡é™ä½ 40%
- ç”¨æˆ·æ»¡æ„åº¦æå‡

---

## 4ï¸âƒ£ ç”¨æˆ·ç•™å­˜æœºåˆ¶ï¼ˆä¼˜å…ˆçº§ï¼šğŸŸ¡ ä¸­ï¼‰

### 4.1 æ¯æ—¥æŒ‘æˆ˜ç³»ç»Ÿ â­â­â­â­

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

```javascript
// config/daily-challenges.json
{
  "challenges": [
    {
      "id": "daily_words_10",
      "name": "æ¯æ—¥å•è¯ç‹",
      "description": "æ”¶é›†10ä¸ªæ–°å•è¯",
      "target": 10,
      "reward": { "diamond": 3, "score": 100 }
    },
    {
      "id": "daily_accuracy_80",
      "name": "å­¦éœ¸æŒ‘æˆ˜",
      "description": "ç­”é¢˜æ­£ç¡®ç‡è¾¾åˆ°80%ï¼ˆè‡³å°‘10é¢˜ï¼‰",
      "target": 0.8,
      "reward": { "diamond": 5, "score": 150 }
    },
    {
      "id": "daily_survival_500",
      "name": "ç”Ÿå­˜å¤§å¸ˆ",
      "description": "å•å±€å¾—åˆ†è¾¾åˆ°500ä¸æ­»äº¡",
      "reward": { "maxHP": 1, "diamond": 2 }
    }
  ],
  "weeklyBonus": {
    "description": "è¿ç»­7å¤©å®Œæˆæ¯æ—¥æŒ‘æˆ˜",
    "reward": { "diamond": 20, "score": 500, "achievement": "weekly_champion" }
  }
}
```

---

### 4.2 ç¤¾äº¤åˆ†äº«ç³»ç»Ÿ â­â­â­

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

```javascript
// ç”Ÿæˆåˆ†äº«å¡ç‰‡
class ShareCardGenerator {
  generateCard(playerData) {
    const canvas = document.createElement('canvas');
    canvas.width = 600;
    canvas.height = 400;
    const ctx = canvas.getContext('2d');
    
    // ç»˜åˆ¶èƒŒæ™¯
    ctx.fillStyle = '#4CAF50';
    ctx.fillRect(0, 0, 600, 400);
    
    // ç»˜åˆ¶æˆå°±
    ctx.fillStyle = '#fff';
    ctx.font = 'bold 36px Arial';
    ctx.textAlign = 'center';
    ctx.fillText(`æˆ‘åœ¨é©¬é‡Œå¥¥è‹±è¯­å­¦ä¹ æ¸¸æˆä¸­`, 300, 80);
    ctx.fillText(`å­¦ä¼šäº† ${playerData.wordsCount} ä¸ªå•è¯ï¼`, 300, 130);
    
    // ç»˜åˆ¶åˆ†æ•°
    ctx.font = 'bold 48px Arial';
    ctx.fillText(`æœ€é«˜åˆ†: ${playerData.highScore}`, 300, 200);
    
    // ç»˜åˆ¶äºŒç»´ç ï¼ˆæ¸¸æˆé“¾æ¥ï¼‰
    // ... QR code generation
    
    return canvas.toDataURL('image/png');
  }
  
  async share(imageData) {
    if (navigator.share) {
      // ä½¿ç”¨Web Share API
      const blob = await (await fetch(imageData)).blob();
      const file = new File([blob], 'achievement.png', { type: 'image/png' });
      
      await navigator.share({
        title: 'æˆ‘çš„è‹±è¯­å­¦ä¹ æˆå°±',
        text: 'å¿«æ¥å’Œæˆ‘ä¸€èµ·å­¦è‹±è¯­ï¼',
        files: [file]
      });
    } else {
      // é™çº§æ–¹æ¡ˆï¼šä¸‹è½½å›¾ç‰‡
      const link = document.createElement('a');
      link.href = imageData;
      link.download = 'achievement.png';
      link.click();
    }
  }
}
```

---

### 4.3 æˆå°±ç³»ç»Ÿå¯è§†åŒ– â­â­â­

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

```javascript
// æˆå°±å¾½ç« å¢™
const achievementWall = {
  categories: [
    {
      name: 'å­¦ä¹ æˆå°±',
      achievements: [
        { id: 'words_100', name: 'è¯æ±‡æ–°æ‰‹', icon: 'ğŸ“š', requirement: 'å­¦ä¼š100ä¸ªå•è¯' },
        { id: 'words_500', name: 'è¯æ±‡è¾¾äºº', icon: 'ğŸ“–', requirement: 'å­¦ä¼š500ä¸ªå•è¯' },
        { id: 'perfect_10', name: 'å®Œç¾å­¦éœ¸', icon: 'ğŸ’¯', requirement: 'è¿ç»­ç­”å¯¹10é¢˜' }
      ]
    },
    {
      name: 'æˆ˜æ–—æˆå°±',
      achievements: [
        { id: 'boss_1', name: 'å‡‹é›¶æ€æ‰‹', icon: 'ğŸ’€', requirement: 'å‡»è´¥å‡‹é›¶' },
        { id: 'combo_20', name: 'è¿å‡»å¤§å¸ˆ', icon: 'âš”ï¸', requirement: 'è¾¾æˆ20è¿å‡»' }
      ]
    },
    {
      name: 'æ¢ç´¢æˆå°±',
      achievements: [
        { id: 'biome_all', name: 'ä¸–ç•Œæ—…è¡Œå®¶', icon: 'ğŸŒ', requirement: 'è®¿é—®æ‰€æœ‰12ä¸ªç¾¤ç³»' },
        { id: 'village_10', name: 'æ‘åº„å¸¸å®¢', icon: 'ğŸ˜ï¸', requirement: 'è®¿é—®10ä¸ªæ‘åº„' }
      ]
    }
  ]
};
```

---

## 5ï¸âƒ£ å®æ–½ä¼˜å…ˆçº§å»ºè®®

### ç¬¬ä¸€é˜¶æ®µï¼ˆ1-2å‘¨ï¼‰ï¼šæ ¸å¿ƒå­¦ä¹ ä½“éªŒ ğŸ”´
1. **è‡ªé€‚åº”å­¦ä¹ è·¯å¾„**ï¼ˆ3å¤©ï¼‰
2. **å­¦ä¹ æ•°æ®å¯è§†åŒ–ä»ªè¡¨ç›˜**ï¼ˆ5å¤©ï¼‰
3. **ç§‘å­¦é—´éš”é‡å¤ç®—æ³•**ï¼ˆ3å¤©ï¼‰
4. **éš¾åº¦æ›²çº¿å¹³æ»‘åŒ–**ï¼ˆ2å¤©ï¼‰

**é¢„æœŸæˆæœ**ï¼šå­¦ä¹ æ•ˆæœå¯é‡åŒ–ï¼ŒæŒ«è´¥æ„Ÿå¤§å¹…é™ä½

### ç¬¬äºŒé˜¶æ®µï¼ˆ2-3å‘¨ï¼‰ï¼šæ¸¸æˆæ·±åº¦æå‡ ğŸŸ¡
1. **æˆ˜æ–—ç­–ç•¥æ·±åº¦ï¼ˆæ­¦å™¨å…‹åˆ¶+è¿å‡»ï¼‰**ï¼ˆ5å¤©ï¼‰
2. **ç¾¤ç³»ç‰¹è‰²ç©æ³•**ï¼ˆ7å¤©ï¼‰
3. **Bossæˆ˜æ‰‹æ„Ÿä¼˜åŒ–**ï¼ˆ3å¤©ï¼‰
4. **æ‹¼å†™ç»ƒä¹ å¼ºåŒ–**ï¼ˆ2å¤©ï¼‰

**é¢„æœŸæˆæœ**ï¼šæ¸¸æˆå¯ç©æ€§ç¿»å€ï¼Œé‡å¤æ€§æå‡

### ç¬¬ä¸‰é˜¶æ®µï¼ˆ3-4å‘¨ï¼‰ï¼šæŠ€æœ¯ä¸ç•™å­˜ ğŸŸ¢
1. **ä»£ç æ¨¡å—åŒ–é‡æ„**ï¼ˆ7å¤©ï¼‰
2. **æ€§èƒ½ä¼˜åŒ–ï¼ˆåˆ†å±‚æ¸²æŸ“+å¯¹è±¡æ± ï¼‰**ï¼ˆ5å¤©ï¼‰
3. **æ¯æ—¥æŒ‘æˆ˜ç³»ç»Ÿ**ï¼ˆ3å¤©ï¼‰
4. **ç§»åŠ¨ç«¯ä½“éªŒä¼˜åŒ–**ï¼ˆ4å¤©ï¼‰
5. **ç¤¾äº¤åˆ†äº«ç³»ç»Ÿ**ï¼ˆ2å¤©ï¼‰

**é¢„æœŸæˆæœ**ï¼šæŠ€æœ¯å€ºåŠ¡æ¸…ç†ï¼Œç”¨æˆ·ç•™å­˜æå‡

---

## 6ï¸âƒ£ æ•°æ®ç›‘æ§å»ºè®®

### å…³é”®æŒ‡æ ‡ï¼ˆKPIï¼‰

**å­¦ä¹ æ•ˆæœæŒ‡æ ‡**ï¼š
- å¹³å‡å•è¯è®°å¿†ç•™å­˜ç‡ï¼ˆ7å¤©åï¼‰
- å­¦ç”Ÿæ­£ç¡®ç‡å˜åŒ–è¶‹åŠ¿
- æ—¥å‡æ–°å­¦å•è¯æ•°
- é—´éš”å¤ä¹ å®Œæˆç‡

**æ¸¸æˆå‚ä¸æŒ‡æ ‡**ï¼š
- æ—¥æ´»è·ƒç”¨æˆ·ï¼ˆDAUï¼‰
- å¹³å‡æ¸¸æˆæ—¶é•¿
- æ¬¡æ—¥ç•™å­˜ç‡ / 7æ—¥ç•™å­˜ç‡
- Bossæˆ˜å®Œæˆç‡

**æŠ€æœ¯æ€§èƒ½æŒ‡æ ‡**ï¼š
- å¹³å‡å¸§ç‡ï¼ˆFPSï¼‰
- åŠ è½½æ—¶é—´ï¼ˆé¦–å±ï¼‰
- å´©æºƒç‡
- ç§»åŠ¨ç«¯ vs PCç«¯ç•™å­˜å¯¹æ¯”

**å»ºè®®å®ç°åŸ‹ç‚¹**ï¼š
```javascript
// src/modules/25-analytics.js
class Analytics {
  track(event, properties = {}) {
    const data = {
      event,
      properties,
      timestamp: Date.now(),
      userId: gameState.account.id,
      sessionId: gameState.sessionId
    };
    
    // å‘é€åˆ°åç«¯æˆ–å­˜å‚¨åˆ°LocalStorage
    this.send(data);
  }
  
  // ä½¿ç”¨ç¤ºä¾‹
  trackLearning(word, isCorrect, responseTime) {
    this.track('word_challenge', {
      word: word.id,
      correct: isCorrect,
      time: responseTime,
      difficulty: word.difficulty
    });
  }
  
  trackGameplay(event, details) {
    this.track('gameplay', {
      event,
      ...details
    });
  }
}
```

---

## 7ï¸âƒ£ æ€»ç»“ä¸å»ºè®®

### æ ¸å¿ƒä»·å€¼ä¿æŒ âœ…
æœ¬é¡¹ç›®çš„**å››å±‚å­¦ä¹ èåˆ**è®¾è®¡ç†å¿µéå¸¸å…ˆè¿›ï¼Œä¼˜åŒ–æ—¶åº”ä¿æŒï¼š
- è¢«åŠ¨æµ¸å…¥ï¼ˆç¯å¢ƒæ ‡ç­¾ï¼‰
- ä¸»åŠ¨æ”¶é›†ï¼ˆè¯è¯­ç‰©å“ï¼‰
- æŒ‘æˆ˜éªŒè¯ï¼ˆå®ç®±å­¦ä¹ ï¼‰
- ç³»ç»Ÿå¤ä¹ ï¼ˆç¾¤ç³»åˆ‡æ¢ï¼‰

### å¹³è¡¡æ¸¸æˆä¸å­¦ä¹ çš„å…³é”®
1. **å­¦ä¹ ä¸åº”æ‰“æ–­å¿ƒæµ**ï¼šä¿æŒç°æœ‰çš„"å­¦ä¹ èå…¥æ¸¸æˆ"è®¾è®¡ï¼Œé¿å…å¼ºåˆ¶åšé¢˜é¡µé¢
2. **æ¸¸æˆåº”æœåŠ¡å­¦ä¹ ç›®æ ‡**ï¼šæˆ˜æ–—éš¾åº¦ã€ç¾¤ç³»åˆ‡æ¢éƒ½åº”ä¸è¯æ±‡å­¦ä¹ è¿›åº¦å…³è”
3. **å¯è§†åŒ–æ­£å‘åé¦ˆ**ï¼šè®©å­¦ç”Ÿå’Œå®¶é•¿çœ‹åˆ°æ¸…æ™°çš„å­¦ä¹ æ•ˆæœ

### æŠ€æœ¯å€ºåŠ¡ä¼˜å…ˆæ¸…ç†
6000è¡Œå•æ–‡ä»¶æ˜¯æœ€å¤§éšæ‚£ï¼Œå»ºè®®ä¼˜å…ˆè¿›è¡Œï¼š
- å®Œå…¨æ¨¡å—åŒ–
- å¼•å…¥æ„å»ºå·¥å…·
- æ€§èƒ½ä¼˜åŒ–ï¼ˆåˆ†å±‚æ¸²æŸ“ï¼‰

### å•†ä¸šåŒ–å»ºè®®ï¼ˆå¯é€‰ï¼‰
å¦‚æœªæ¥è€ƒè™‘å•†ä¸šåŒ–ï¼Œå¯å¢åŠ ï¼š
- å¤šäººæ¨¡å¼ï¼ˆPvPå­¦ä¹ å¯¹æˆ˜ï¼‰
- æ•™å¸ˆç®¡ç†åå°ï¼ˆç­çº§è¯æ±‡å®šåˆ¶ï¼‰
- VIPä¼šå‘˜ï¼ˆæ›´å¤šè¯åº“ã€ä¸“å±ç¾¤ç³»ï¼‰

---

## ğŸ“ é™„å½•ï¼šå¿«é€Ÿæ£€æŸ¥æ¸…å•

**å­¦ä¹ ç³»ç»Ÿæ£€æŸ¥**ï¼š
- [ ] è‡ªé€‚åº”å­¦ä¹ è·¯å¾„å·²å®ç°
- [ ] å­¦ä¹ æ•°æ®å¯è§†åŒ–ä»ªè¡¨ç›˜å·²ä¸Šçº¿
- [ ] é—´éš”é‡å¤ç®—æ³•å·²ä¼˜åŒ–
- [ ] ä¾‹å¥å’Œè¯­å¢ƒå·²æ·»åŠ 

**æ¸¸æˆæ€§æ£€æŸ¥**ï¼š
- [ ] éš¾åº¦æ›²çº¿å·²å¹³æ»‘åŒ–
- [ ] æ­¦å™¨å…‹åˆ¶ç³»ç»Ÿå·²å®ç°
- [ ] è¿å‡»ç³»ç»Ÿå·²å®ç°
- [ ] ç¾¤ç³»ç‰¹è‰²ç©æ³•å·²ä¸Šçº¿

**æŠ€æœ¯æ€§èƒ½æ£€æŸ¥**ï¼š
- [ ] ä»£ç å·²å®Œå…¨æ¨¡å—åŒ–
- [ ] åˆ†å±‚æ¸²æŸ“å·²å®ç°
- [ ] å¯¹è±¡æ± å·²åº”ç”¨
- [ ] ç§»åŠ¨ç«¯ä½“éªŒå·²ä¼˜åŒ–

**ç”¨æˆ·ç•™å­˜æ£€æŸ¥**ï¼š
- [ ] æ¯æ—¥æŒ‘æˆ˜ç³»ç»Ÿå·²ä¸Šçº¿
- [ ] æˆå°±ç³»ç»Ÿå¯è§†åŒ–å·²å®Œæˆ
- [ ] ç¤¾äº¤åˆ†äº«åŠŸèƒ½å·²å®ç°
- [ ] æ•°æ®åŸ‹ç‚¹å·²éƒ¨ç½²

---

**æŠ¥å‘Šç‰ˆæœ¬**: v1.0  
**å»ºè®®æœ‰æ•ˆæœŸ**: 2026å¹´Q1-Q2  
**ä¸‹æ¬¡æ›´æ–°**: æ ¹æ®å®æ–½æƒ…å†µè°ƒæ•´
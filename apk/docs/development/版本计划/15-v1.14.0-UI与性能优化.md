# v1.14.0 â€” UI/UX ä¸æ€§èƒ½ä¼˜åŒ–

> **ä¼˜å…ˆçº§**: P2
> **ç‰ˆæœ¬å·**: 1.14.0 / versionCode: 92
> **å‰ç½®ç‰ˆæœ¬**: v1.13.0ï¼ˆå­¦ä¹ ç®—æ³•ä¸é¢˜å‹å¢å¼ºå®Œæˆï¼‰
> **é¢„æœŸæ•ˆæœ**: æ¸¸æˆç»“æŸå±•ç¤ºæœ¬å±€å•è¯ã€è¯å¡æ—¶é•¿å¯é…ç½®ã€æŒ‘æˆ˜é¢‘ç‡è¯­ä¹‰åŒ–ã€ç²’å­å¯¹è±¡æ± å‡å°‘ GC

---

## é—®é¢˜æè¿°

1. **æ¸¸æˆç»“æŸç¼ºå°‘å­¦ä¹ å›é¡¾**ï¼š`10-ui.js:36-41` åªæ˜¾ç¤ºç»Ÿè®¡æ•°å­—ï¼Œä¸å±•ç¤ºæœ¬å±€å­¦åˆ°äº†å“ªäº›è¯ï¼Œç¼ºå°‘æˆå°±æ„Ÿã€‚`sessionCollectedWords` æ•°ç»„å·²æœ‰æ•°æ®ä½†æœªåˆ©ç”¨ã€‚
2. **è¯å¡æ˜¾ç¤ºæ—¶é—´å›ºå®š**ï¼š`12-challenges.js:30-33` è¯å¡å›ºå®š 900ms æ¶ˆå¤±ï¼Œå¯¹ä½é¾„å„¿ç«¥å¯èƒ½å¤ªå¿«ã€‚
3. **æŒ‘æˆ˜é¢‘ç‡è®¾ç½®ä¸ç›´è§‚**ï¼š`settings.challengeFrequency` æ˜¯ 0-1 çš„æ•°å­—ï¼Œç”¨æˆ·ä¸ç†è§£å«ä¹‰ã€‚
4. **ç²’å­ GC å‹åŠ›**ï¼š`06-biome.js:221-248` æ¯å¸§ `new` ç²’å­å¯¹è±¡ï¼Œé«˜é¢‘åˆ›å»º/é”€æ¯å¯¼è‡´ GC æŠ–åŠ¨ã€‚

---

## ä¿®æ”¹æ¸…å•

### Step 1: æ¸¸æˆç»“æŸç»Ÿè®¡å¢å¼º

#### æ–‡ä»¶: `src/modules/10-ui.js`

**ä½ç½®**: `setOverlay()` å‡½æ•°ä¸­ `mode === "gameover"` åˆ†æ”¯ï¼ˆçº¦ç¬¬ 31-42 è¡Œï¼‰

**å½“å‰ä»£ç **:
```javascript
if (text) {
    const level = Math.max(1, Math.floor(score / 1000) + 1);
    text.innerHTML =
        `ğŸ“š å­¦ä¹ å•è¯: ${getLearnedWordCount()}<br>` +
        `ğŸ’ é’»çŸ³: ${diamonds}<br>` +
        `â­ å½“å‰ç§¯åˆ†: ${score}<br>` +
        `âš”ï¸ å‡»æ€æ•Œäºº: ${enemyKillStats.total || 0}<br>` +
        `ğŸ… ç©å®¶ç­‰çº§: ${level}`;
}
```

**æ”¹ä¸º**:
```javascript
if (text) {
    const level = Math.max(1, Math.floor(score / 1000) + 1);
    const uniqueWords = getUniqueSessionWords();
    const wordListHtml = uniqueWords.length
        ? uniqueWords.slice(0, 8).map(w =>
            `<span style="display:inline-block; background:rgba(255,255,255,0.1); ` +
            `padding:2px 6px; margin:2px; border-radius:4px; font-size:12px;">${w.en}</span>`
        ).join("")
        : "æ— ";
    const moreText = uniqueWords.length > 8
        ? `<span style="color:#888; font-size:11px;"> +${uniqueWords.length - 8}ä¸ª</span>`
        : "";
    text.innerHTML =
        `ğŸ“š å­¦ä¹ å•è¯: ${getLearnedWordCount()}<br>` +
        `ğŸ’ é’»çŸ³: ${diamonds}<br>` +
        `â­ å½“å‰ç§¯åˆ†: ${score}<br>` +
        `âš”ï¸ å‡»æ€æ•Œäºº: ${enemyKillStats.total || 0}<br>` +
        `ğŸ… ç©å®¶ç­‰çº§: ${level}<br>` +
        `<div style="margin-top:8px; font-size:13px; color:#FFD54F;">` +
        `æœ¬å±€å•è¯: ${wordListHtml}${moreText}</div>`;
}
```

**éªŒè¯**: æ¸¸æˆç»“æŸç•Œé¢åº•éƒ¨æ˜¾ç¤ºæœ¬å±€æ”¶é›†çš„å•è¯æ ‡ç­¾ï¼ˆæœ€å¤š 8 ä¸ªï¼‰ï¼Œè¶…å‡ºæ˜¾ç¤º "+Nä¸ª"ã€‚

---

### Step 2: è¯å¡å±•ç¤ºæ—¶é—´å¯é…ç½®

#### æ–‡ä»¶ A: `src/modules/09-vocab.js`

**ä½ç½®**: `normalizeSettings()` å‡½æ•°ï¼ˆçº¦ç¬¬ 5 è¡Œï¼‰

**æ“ä½œ**: åœ¨å‡½æ•°æœ«å°¾ `return merged;` ä¹‹å‰æ·»åŠ é»˜è®¤å€¼:
```javascript
if (typeof merged.wordCardDuration !== "number") merged.wordCardDuration = 900;
```

#### æ–‡ä»¶ B: `src/modules/12-challenges.js`

**ä½ç½®**: `showWordCard()` å‡½æ•°ä¸­çš„ `setTimeout`ï¼ˆçº¦ç¬¬ 30 è¡Œï¼‰

**å½“å‰ä»£ç **:
```javascript
setTimeout(() => {
    card.classList.remove("visible");
    card.setAttribute("aria-hidden", "true");
}, 900);
```

**æ”¹ä¸º**:
```javascript
setTimeout(() => {
    card.classList.remove("visible");
    card.setAttribute("aria-hidden", "true");
}, settings.wordCardDuration || 900);
```

#### æ–‡ä»¶ C: `Game.html`

**ä½ç½®**: è®¾ç½®é¢æ¿åŒºåŸŸï¼ˆæœç´¢ `opt-` ç³»åˆ—è®¾ç½®é¡¹é™„è¿‘ï¼‰

**æ“ä½œ**: æ·»åŠ è¯å¡æ—¶é•¿é€‰æ‹©:
```html
<div class="setting-row">
    <label>è¯å¡æ˜¾ç¤ºæ—¶é•¿</label>
    <select id="opt-word-card-duration">
        <option value="600">çŸ­ (0.6ç§’)</option>
        <option value="900">ä¸­ (0.9ç§’)</option>
        <option value="2000">é•¿ (2ç§’)</option>
        <option value="3000">å¾ˆé•¿ (3ç§’)</option>
    </select>
</div>
```

#### æ–‡ä»¶ D: `src/modules/16-events.js`

**ä½ç½®**: è®¾ç½®é¢æ¿äº‹ä»¶ç»‘å®šåŒºåŸŸ

**æ“ä½œ**: æ·»åŠ äº‹ä»¶ç›‘å¬:
```javascript
const durationSel = document.getElementById("opt-word-card-duration");
if (durationSel) {
    durationSel.value = String(settings.wordCardDuration || 900);
    durationSel.addEventListener("change", () => {
        settings.wordCardDuration = Number(durationSel.value) || 900;
        saveSettings();
    });
}
```

**éªŒè¯**: è®¾ç½®é¢æ¿ä¸­é€‰æ‹©"é•¿"ï¼Œæ”¶é›†å•è¯æ—¶è¯å¡æ˜¾ç¤º 2 ç§’åæ¶ˆå¤±ã€‚

---

### Step 3: æŒ‘æˆ˜é¢‘ç‡è¯­ä¹‰åŒ–

#### æ–‡ä»¶ A: `Game.html`

**ä½ç½®**: è®¾ç½®é¢æ¿ä¸­æŒ‘æˆ˜é¢‘ç‡ç›¸å…³æ§ä»¶

**æ“ä½œ**: å°†æ•°å­—æ»‘å—æ›¿æ¢ä¸ºè¯­ä¹‰åŒ–é€‰é¡¹:
```html
<div class="setting-row">
    <label>æŒ‘æˆ˜é¢‘ç‡</label>
    <select id="opt-challenge-frequency">
        <option value="0.15">å¾ˆå°‘</option>
        <option value="0.3">é€‚ä¸­</option>
        <option value="0.5">é¢‘ç¹</option>
    </select>
</div>
```

#### æ–‡ä»¶ B: `src/modules/16-events.js`

**ä½ç½®**: æŒ‘æˆ˜é¢‘ç‡äº‹ä»¶ç»‘å®š

**æ“ä½œ**: æ›´æ–°äº‹ä»¶ç»‘å®šä»¥åŒ¹é…æ–°çš„ select å…ƒç´ :
```javascript
const freqSel = document.getElementById("opt-challenge-frequency");
if (freqSel) {
    // æ‰¾åˆ°æœ€æ¥è¿‘å½“å‰å€¼çš„é€‰é¡¹
    const currentFreq = Number(settings.challengeFrequency ?? 0.3);
    const options = [0.15, 0.3, 0.5];
    const closest = options.reduce((a, b) =>
        Math.abs(b - currentFreq) < Math.abs(a - currentFreq) ? b : a
    );
    freqSel.value = String(closest);
    freqSel.addEventListener("change", () => {
        settings.challengeFrequency = Number(freqSel.value) || 0.3;
        saveSettings();
    });
}
```

**éªŒè¯**: è®¾ç½®é¢æ¿ä¸­é€‰æ‹©"é¢‘ç¹"ï¼Œæ¸¸æˆä¸­æŒ‘æˆ˜è§¦å‘æ˜æ˜¾æ›´é¢‘ç¹ã€‚

---

### Step 4: ç²’å­å¯¹è±¡æ± 

#### æ–‡ä»¶ A: `src/modules/15-entities-particles.js`

**ä½ç½®**: æ–‡ä»¶é¡¶éƒ¨ï¼ˆç²’å­ç±»å®šä¹‰ä¹‹å‰æˆ–ä¹‹åï¼‰

**æ“ä½œ**: æ–°å¢ `ParticlePool` ç±»:
```javascript
class ParticlePool {
    constructor(ParticleClass, size = 50) {
        this._pool = [];
        this._Class = ParticleClass;
        for (let i = 0; i < size; i++) {
            this._pool.push(new ParticleClass(0, 0));
        }
    }
    acquire(x, y) {
        const p = this._pool.length > 0
            ? this._pool.pop()
            : new this._Class(x, y);
        p.x = x;
        p.y = y;
        p.life = 1.0;
        p.remove = false;
        return p;
    }
    release(p) {
        if (this._pool.length < 100) { // é˜²æ­¢æ± æ— é™å¢é•¿
            this._pool.push(p);
        }
    }
}
```

åœ¨ç²’å­ç±»å®šä¹‰ä¹‹ååˆ›å»ºæ± å®ä¾‹:
```javascript
const snowflakePool = new ParticlePool(Snowflake, 40);
const leafPool = new ParticlePool(LeafParticle, 30);
const dustPool = new ParticlePool(DustParticle, 30);
```

#### æ–‡ä»¶ B: `src/modules/06-biome.js`

**ä½ç½®**: `spawnBiomeParticles()` å‡½æ•°ï¼ˆçº¦ç¬¬ 221 è¡Œï¼‰

**æ“ä½œ**: å°† `new Snowflake(...)` ç­‰æ›¿æ¢ä¸ºå¯¹è±¡æ± è·å–:
```javascript
// åŸæ¥: particles.push(new Snowflake(baseX, -10));
// æ”¹ä¸º: particles.push(snowflakePool.acquire(baseX, -10));

// åŸæ¥: particles.push(new LeafParticle(baseX, -10));
// æ”¹ä¸º: particles.push(leafPool.acquire(baseX, -10));

// åŸæ¥: particles.push(new DustParticle(baseX, ...));
// æ”¹ä¸º: particles.push(dustPool.acquire(baseX, ...));
```

æ³¨æ„ï¼š`EmberParticle`ã€`BubbleParticle`ã€`SparkleParticle`ã€`EndParticle`ã€`RainParticle` é¢‘ç‡è¾ƒä½ï¼Œæš‚ä¸æ± åŒ–ã€‚

#### æ–‡ä»¶ C: `src/modules/13-game-loop.js`

**ä½ç½®**: ç²’å­æ¸…ç†é€»è¾‘ï¼ˆæœç´¢ `particles = particles.filter` æˆ–ç²’å­ remove åˆ¤æ–­ï¼‰

**æ“ä½œ**: ç²’å­ç§»é™¤æ—¶å›æ”¶åˆ°å¯¹åº”æ± :
```javascript
particles = particles.filter(p => {
    if (p.remove || p.life <= 0) {
        // å›æ”¶åˆ°å¯¹åº”æ± 
        if (p instanceof Snowflake) snowflakePool.release(p);
        else if (p instanceof LeafParticle) leafPool.release(p);
        else if (p instanceof DustParticle) dustPool.release(p);
        return false;
    }
    return true;
});
```

**éªŒè¯**: åœ¨é›ªåœ°ç¾¤ç³»é•¿æ—¶é—´æ¸¸ç©ï¼Œè§‚å¯Ÿ DevTools Performance é¢æ¿ä¸­ GC é¢‘ç‡æ˜¯å¦é™ä½ã€‚ç²’å­è§†è§‰æ•ˆæœåº”ä¸ä¹‹å‰ä¸€è‡´ã€‚

---

## éªŒè¯æ­¥éª¤

### A. æ¸¸æˆç»“æŸç»Ÿè®¡éªŒè¯

1. æ¸¸ç©ä¸€å±€ï¼Œæ”¶é›†è‹¥å¹²å•è¯åæ­»äº¡ã€‚
2. æ¸¸æˆç»“æŸç•Œé¢åº•éƒ¨åº”æ˜¾ç¤ºæœ¬å±€æ”¶é›†çš„å•è¯æ ‡ç­¾ã€‚
3. æ”¶é›†è¶…è¿‡ 8 ä¸ªä¸åŒå•è¯æ—¶ï¼Œåº”æ˜¾ç¤º "+Nä¸ª"ã€‚

### B. è¯å¡æ—¶é•¿éªŒè¯

1. è®¾ç½®ä¸­é€‰æ‹©"é•¿ (2ç§’)"ã€‚
2. æ”¶é›†å•è¯ï¼Œè¯å¡åº”æ˜¾ç¤ºçº¦ 2 ç§’åæ¶ˆå¤±ã€‚
3. åˆ‡æ¢å›"ä¸­ (0.9ç§’)"ï¼Œç¡®è®¤æ¢å¤é»˜è®¤é€Ÿåº¦ã€‚

### C. æŒ‘æˆ˜é¢‘ç‡éªŒè¯

1. è®¾ç½®ä¸­é€‰æ‹©"å¾ˆå°‘"ï¼Œæ¸¸ç©ä¸€æ®µæ—¶é—´ï¼Œè®°å½•æŒ‘æˆ˜è§¦å‘æ¬¡æ•°ã€‚
2. åˆ‡æ¢ä¸º"é¢‘ç¹"ï¼ŒåŒæ ·æ—¶é—´å†…æŒ‘æˆ˜è§¦å‘åº”æ˜æ˜¾æ›´å¤šã€‚

### D. ç²’å­æ€§èƒ½éªŒè¯

1. è¿›å…¥é›ªåœ°ç¾¤ç³»ï¼Œé•¿æ—¶é—´æ¸¸ç©ï¼ˆ2+ åˆ†é’Ÿï¼‰ã€‚
2. æ‰“å¼€ DevTools â†’ Performanceï¼Œè§‚å¯Ÿ GC æš‚åœé¢‘ç‡ã€‚
3. ç²’å­è§†è§‰æ•ˆæœåº”ä¸æ”¹åŠ¨å‰ä¸€è‡´ï¼ˆé›ªèŠ±ã€æ ‘å¶ã€æ²™å°˜ï¼‰ã€‚

### E. å›å½’éªŒè¯ï¼ˆå¿…é¡»ï¼‰

1. é¦–é¡µé¦–æ¬¡è¿›å…¥ä¸é‡è¿›ååœ°é¢æŒç»­å¯è§ã€‚
2. è§¦æ§æŒ‰é’®ä¸ä¸¢å¤±å“åº”ã€‚
3. BOSS ä¸æ‘åº„è§¦å‘é“¾è·¯ä¸å›å½’ã€‚
4. v1.12.0/v1.13.0 åŠŸèƒ½æ­£å¸¸ã€‚

---

## ç‰ˆæœ¬å‘å¸ƒæ­¥éª¤

```bash
# 1. æ›´æ–°ç‰ˆæœ¬å·
# apk/package.json â†’ "version": "1.14.0"
# apk/android-app/package.json â†’ "version": "1.14.0"
# build.gradle â†’ versionName "1.14.0", versionCode 92

# 2. æ›´æ–°ç‰ˆæœ¬æ–‡æ¡£
# docs/version/CHANGELOG.md â†’ è¿½åŠ  v1.14.0 æ¡ç›®
# docs/version/Progress.md â†’ è¿½åŠ  v1.14.0 æ¡ç›®

# 3. æäº¤
git add src/modules/10-ui.js src/modules/12-challenges.js src/modules/09-vocab.js
git add src/modules/15-entities-particles.js src/modules/06-biome.js src/modules/13-game-loop.js
git add src/modules/16-events.js Game.html
git add apk/package.json apk/android-app/package.json
git add docs/version/CHANGELOG.md docs/version/Progress.md
git commit -m "feat(v1.14.0): gameover word list, configurable word card, semantic challenge freq, particle pool"

# 4. æ¨é€
push.bat
```

---

## CHANGELOG æ¡ç›®ï¼ˆé¢„å†™ï¼‰

```markdown
## v1.14.0 (2026-02-xx)

### UI/UX
- æ¸¸æˆç»“æŸç•Œé¢æ–°å¢æœ¬å±€æ”¶é›†å•è¯å±•ç¤ºï¼ˆæœ€å¤š 8 ä¸ªï¼‰
- è¯å¡æ˜¾ç¤ºæ—¶é•¿å¯åœ¨è®¾ç½®ä¸­è°ƒèŠ‚ï¼ˆçŸ­/ä¸­/é•¿/å¾ˆé•¿ï¼‰
- æŒ‘æˆ˜é¢‘ç‡è®¾ç½®æ”¹ä¸ºè¯­ä¹‰åŒ–é€‰é¡¹ï¼ˆå¾ˆå°‘/é€‚ä¸­/é¢‘ç¹ï¼‰

### æ€§èƒ½
- é«˜é¢‘ç²’å­ï¼ˆé›ªèŠ±ã€æ ‘å¶ã€æ²™å°˜ï¼‰æ”¹ç”¨å¯¹è±¡æ± ï¼Œå‡å°‘ GC å‹åŠ›
```

---

*ç¼–åˆ¶æ—¥æœŸï¼š2026-02-16*

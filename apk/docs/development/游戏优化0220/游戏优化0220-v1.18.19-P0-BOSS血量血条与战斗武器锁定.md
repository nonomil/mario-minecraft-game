# v1.18.19 (P0) - BOSS血量血条与战斗武器锁定

## 1. 版本目标

- BOSS 血量整体提升为当前的 2 倍。
- BOSS 血条稳定显示（含阶段信息）。
- 进入 BOSS 战自动切换主武器为剑并临时锁定，战后恢复。
- 小 BOSS 实现轮换（至少凋零/恶魂交替）。

## 2. 计划修改文件

- `apk/src/modules/15-entities-boss.js`
- `apk/src/modules/04-weapons.js`
- `apk/src/modules/13-game-loop.js`
- `apk/src/modules/01-config.js`（如将轮换策略外置配置）

## 3. Step by Step

1. BOSS 血量倍率
- 在 BOSS 构造配置入口加 `hpMultiplier`（默认 2.0）。
- 统一乘到 `maxHp`，并保持 `hp = maxHp` 初始化逻辑。

2. 血条显示校准
- 验证 `renderBossHpBar` 在所有 BOSS 类型进入后都可见。
- 修正乱码与阶段文案，确保中文正常显示。

3. 武器锁定机制
- `bossArena.enter()` 时保存当前武器。
- 自动切到 `stone_sword/sword` 可攻击状态。
- BOSS 战期间禁用切换到弓/镐（仅战斗态限制）。
- `bossArena.exit()/onVictory()` 恢复锁定前武器。

4. 小 BOSS 轮换
- `bossArena` 新增 `smallBossRotationIndex`。
- 轮换序列：`wither -> ghast -> blaze -> wither_skeleton -> ...`
- 门禁 BOSS 与固定分数 BOSS分别验证，不互相污染。

## 4. 验收标准

- BOSS 击杀耗时明显提升（约 1.7x~2.2x）。
- 血条全程存在，无乱码。
- BOSS 战中不会因武器误切导致无法攻击。
- 连续触发两次小 BOSS，类型不同。

## 5. 风险与回滚

- 风险：武器锁定影响非 BOSS 战操作体验。
- 防护：锁定仅在 `bossArena.active === true` 时生效。

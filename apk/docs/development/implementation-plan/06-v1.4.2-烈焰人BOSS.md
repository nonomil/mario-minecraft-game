# Step 6: v1.4.2 - çƒˆç„°äººBOSS

## ç‰ˆæœ¬ä¿¡æ¯
- **ç‰ˆæœ¬å·**: 1.4.2
- **versionCode**: 43
- **ä¸»é¢˜**: ç¬¬ä¸‰ä¸ªBOSS - çƒˆç„°äººï¼ˆç«ç„°æ—‹é£ + å¬å”¤å°æ€ªï¼‰
- **å‰ç½®ç‰ˆæœ¬**: v1.4.1

## ç›®æ ‡
å®ç°çƒˆç„°äººBOSSï¼Œç‰¹è‰²æ˜¯ä¸‰è¿ç«çƒã€ç«ç„°æ—‹é£è¿½è¸ªã€å¬å”¤å°çƒˆç„°äººã€‚

## ä¿®æ”¹æ¸…å•

### 1. åœ¨ `15-entities-boss.js` ä¸­æ–°å¢ BlazeBoss ç±»

```javascript
class BlazeBoss extends Boss {
    constructor() {
        super({
            name: 'çƒˆç„°äºº Blaze',
            maxHp: 28,
            color: '#FFD700',
            width: 48,
            height: 64,
            phaseThresholds: [0.7, 0.5]
        });
        this.rotationAngle = 0;    // æ—‹è½¬è§’åº¦
        this.floatY = 100;         // æµ®ç©ºé«˜åº¦
        this.floatDir = 1;
        this.fireColumns = [];     // ç«ç„°æŸ±
        this.minions = [];         // å°çƒˆç„°äºº
        this.minionsSummoned = false;
    }
}
```

### 2. ä¸‰ç§æ”»å‡»æ¨¡å¼

**æ”»å‡»ä¸€ï¼šä¸‰è¿ç«çƒï¼ˆå§‹ç»ˆæ¿€æ´»ï¼‰**:

```javascript
// æ¯4ç§’å‘å°„3ä¸ªç«çƒï¼Œé—´éš”0.3ç§’
phaseOneBehavior(dt) {
    this.attackTimer++;
    if (this.attackTimer >= 240) { // 4ç§’
        this.fireballBurst(3, 18); // 3ä¸ªï¼Œé—´éš”18å¸§(0.3ç§’)
        this.attackTimer = 0;
    }
    this.updateFloat(dt);
}

fireballBurst(count, interval) {
    for (let i = 0; i < count; i++) {
        setTimeout(() => {
            const angle = Math.atan2(player.y - this.y, player.x - this.x);
            this.projectiles.push({
                x: this.x + this.width/2,
                y: this.y + this.height/2,
                vx: Math.cos(angle) * 4,
                vy: Math.sin(angle) * 4,
                damage: 1, size: 10,
                color: '#FF4500'
            });
        }, i * interval * 16.67); // å¸§è½¬æ¯«ç§’
    }
}
```

**æ”»å‡»äºŒï¼šç«ç„°æ—‹é£ï¼ˆè¡€é‡<70%æ¿€æ´»ï¼‰**:

```javascript
// æ¯10ç§’ç”Ÿæˆ3ä¸ªè¿½è¸ªç«ç„°æŸ±
spawnFireColumns() {
    for (let i = 0; i < 3; i++) {
        this.fireColumns.push({
            x: Math.random() * (canvas.width - 40) + 20,
            y: canvas.height - 60, // åœ°é¢
            width: 20,
            height: 60,
            life: 480, // 8ç§’
            trackSpeed: 0.8
        });
    }
}

updateFireColumns(dt) {
    this.fireColumns.forEach(col => {
        // ç¼“æ…¢è¿½è¸ªç©å®¶Xä½ç½®
        const dx = player.x - col.x;
        col.x += Math.sign(dx) * col.trackSpeed;
        col.life--;

        // ç¢°æ’æ£€æµ‹ï¼šæ¯ç§’1å¿ƒä¼¤å®³
        if (col.life % 60 === 0 && isOverlapping(player, col)) {
            player.takeDamage(1);
        }
    });
    // ç§»é™¤è¿‡æœŸç«ç„°æŸ±
    this.fireColumns = this.fireColumns.filter(c => c.life > 0);
}
```

**æ”»å‡»ä¸‰ï¼šå¬å”¤å°æ€ªï¼ˆè¡€é‡<50%æ¿€æ´»ï¼Œä»…ä¸€æ¬¡ï¼‰**:

```javascript
summonMinions() {
    if (this.minionsSummoned) return;
    this.minionsSummoned = true;

    for (let i = 0; i < 2; i++) {
        this.minions.push({
            x: this.x + (i === 0 ? -80 : 80),
            y: this.y,
            hp: 8, maxHp: 8,
            width: 24, height: 32,
            speed: 2.5,
            attackTimer: 0,
            alive: true
        });
    }
    showFloatingText('ğŸ”¥ å¬å”¤å°çƒˆç„°äºº!', this.x, this.y - 20, '#FF4500');
}

// å°çƒˆç„°äººAIï¼šè¿½è¸ªç©å®¶ï¼Œå‘å°„å•å‘ç«çƒ
updateMinions(dt) {
    this.minions.forEach(m => {
        if (!m.alive) return;
        // è¿½è¸ªç©å®¶
        const dx = player.x - m.x;
        m.x += Math.sign(dx) * m.speed;
        // æ¯3ç§’å‘å°„ç«çƒ
        m.attackTimer++;
        if (m.attackTimer >= 180) {
            this.projectiles.push({
                x: m.x, y: m.y,
                vx: Math.sign(dx) * 3, vy: 0,
                damage: 1, size: 8, color: '#FF6600'
            });
            m.attackTimer = 0;
        }
    });
}

// å°æ€ªå…¨ç­å‰BOSSæ— æ•Œï¼ˆå¯é€‰ï¼Œå¢åŠ ç­–ç•¥æ€§ï¼‰
// æˆ–è€…ï¼šå°æ€ªå­˜æ´»æ—¶BOSSé˜²å¾¡+50%
```

### 3. çƒˆç„°äººæ¸²æŸ“

```javascript
render(ctx) {
    // æ—‹è½¬çš„çƒˆç„°æ£’èº«ä½“
    this.rotationAngle += 0.05;
    const cx = this.x + this.width/2;
    const cy = this.y + this.height/2;

    // ä¸­å¿ƒæ ¸å¿ƒï¼ˆé»„è‰²ï¼‰
    ctx.fillStyle = this.flashTimer > 0 ? '#FFF' : '#FFD700';
    ctx.fillRect(this.x + 8, this.y + 8, this.width - 16, this.height - 16);

    // æ—‹è½¬çƒˆç„°æ£’ï¼ˆ4æ ¹ï¼‰
    ctx.fillStyle = '#FF8C00';
    for (let i = 0; i < 4; i++) {
        const angle = this.rotationAngle + (Math.PI/2) * i;
        const bx = cx + Math.cos(angle) * 28 - 4;
        const by = cy + Math.sin(angle) * 28 - 12;
        ctx.fillRect(bx, by, 8, 24);
    }

    // çœ¼ç›
    ctx.fillStyle = '#FF0000';
    ctx.fillRect(this.x + 14, this.y + 20, 6, 6);
    ctx.fillRect(this.x + 28, this.y + 20, 6, 6);

    // ç«ç„°ç²’å­ç¯ç»•
    for (let i = 0; i < 3; i++) {
        const px = cx + Math.cos(Date.now()/200 + i*2) * 20;
        const py = cy + Math.sin(Date.now()/200 + i*2) * 20;
        ctx.fillStyle = `rgba(255, ${100 + Math.random()*100}, 0, 0.6)`;
        ctx.fillRect(px - 2, py - 2, 4, 4);
    }

    // æ¸²æŸ“ç«ç„°æŸ±
    this.fireColumns.forEach(col => {
        // æ©™çº¢è‰²æ—‹è½¬æ–¹å—æŸ±
        ctx.fillStyle = `rgba(255, 69, 0, ${col.life > 60 ? 0.8 : col.life/60 * 0.8})`;
        ctx.fillRect(col.x, col.y - col.height, col.width, col.height);
        // ç«ç„°é¡¶éƒ¨
        ctx.fillStyle = '#FFD700';
        ctx.fillRect(col.x - 2, col.y - col.height - 8, col.width + 4, 8);
    });

    // æ¸²æŸ“å°çƒˆç„°äºº
    this.minions.forEach(m => {
        if (!m.alive) return;
        ctx.fillStyle = '#FF8C00';
        ctx.fillRect(m.x, m.y, m.width, m.height);
        // å°è¡€æ¡
        const hpPercent = m.hp / m.maxHp;
        ctx.fillStyle = '#F44336';
        ctx.fillRect(m.x, m.y - 6, m.width * hpPercent, 3);
    });
}
```

### 4. çƒˆç„°äººç§»åŠ¨

```javascript
updateFloat(dt) {
    // å‚ç›´é£˜ç§»ï¼ˆå±å¹•ä¸Šæ–¹åŒºåŸŸï¼‰
    this.floatY += this.floatDir * 0.5;
    if (this.floatY <= 60 || this.floatY >= 180) {
        this.floatDir *= -1;
    }
    this.y = this.floatY;

    // æ°´å¹³ç¼“æ…¢è¿½è¸ªç©å®¶
    const dx = player.x - this.x;
    this.x += Math.sign(dx) * 0.5;
}
```

## æµ‹è¯•è¦ç‚¹

1. ç¬¬15å…³åè¿›å…¥çƒˆç„°äººBOSSæˆ˜
2. çƒˆç„°äººæµ®ç©ºï¼Œæœ‰æ—‹è½¬çƒˆç„°æ£’åŠ¨ç”»
3. ä¸‰è¿ç«çƒæ­£å¸¸å‘å°„
4. è¡€é‡<70% â†’ å‡ºç°ç«ç„°æŸ±è¿½è¸ªç©å®¶
5. è¡€é‡<50% â†’ å¬å”¤2åªå°çƒˆç„°äºº
6. å°çƒˆç„°äººè¿½è¸ªç©å®¶å¹¶å‘å°„ç«çƒ
7. å‡»æ€å°çƒˆç„°äººåç»§ç»­æ”»å‡»BOSS
8. å‡»æ€BOSS â†’ å¥–åŠ±

## æäº¤ä¿¡æ¯

```
feat: çƒˆç„°äººBOSS - ç«ç„°æ—‹é£ä¸å¬å”¤ (v1.4.2)

- æ–°å¢çƒˆç„°äººBOSSï¼ˆ28è¡€ï¼Œæµ®ç©ºæˆ˜æ–—ï¼‰
- ä¸‰è¿ç«çƒæ”»å‡»
- ç«ç„°æ—‹é£ï¼šè¿½è¸ªç«ç„°æŸ±æŒç»­ä¼¤å®³
- å¬å”¤2åªå°çƒˆç„°äºº
- æ—‹è½¬çƒˆç„°æ£’è§†è§‰æ•ˆæœ
```

# é©¬é‡Œå¥¥Ã—æˆ‘çš„ä¸–ç•Œè‹±è¯­å­¦ä¹ æ¸¸æˆ - ç»¼åˆä¼˜åŒ–æ–¹æ¡ˆ

> åŸºäºä»£ç å®¡æŸ¥ã€ç°çŠ¶åˆ†æä¸æŠ€æœ¯éªŒè¯ï¼Œ2026-02-15

---

## ä¸€ã€æ‰§è¡Œæ‘˜è¦

### æ ¸å¿ƒé—®é¢˜è¯Šæ–­

**å­¦ä¹ ç³»ç»Ÿç°çŠ¶**ï¼š
- âœ… å·²æœ‰å®Œå–„çš„ä¸‰å¥—ç­”é¢˜æœºåˆ¶ï¼ˆChallenge/WordGate/WordMatchï¼‰
- âœ… å·²æœ‰ç§‘å­¦çš„è¯æ±‡ç®¡ç†ç³»ç»Ÿï¼ˆåˆ†çº§+é—´éš”é‡å¤ï¼‰
- âŒ Challenge éšæœºå¼¹å‡ºæ‰“æ–­æ¸¸æˆå¿ƒæµ
- âŒ ç¼ºå°‘è¢«åŠ¨æµ¸å…¥å¼å­¦ä¹ é€šé“
- âŒ ç¼ºå°‘ç­”é¢˜æ­£ç¡®ç‡ç»Ÿè®¡å’Œæ•°æ®å¯è§†åŒ–
- âŒ å®ç®±ç³»ç»Ÿä¸å­¦ä¹ å®Œå…¨åˆ†ç¦»ï¼ˆæµªè´¹äº†æœ€æœ‰æœŸå¾…æ„Ÿçš„å­¦ä¹ è§¦å‘ç‚¹ï¼‰

**æŠ€æœ¯æ¶æ„ç‰¹ç‚¹**ï¼š
- å…¨å±€çŠ¶æ€æ¨¡å¼ï¼ˆéå›è°ƒæ¨¡å¼ï¼‰
- æ— ç¦»æ•£å…³å¡ç³»ç»Ÿï¼ˆåŸºäº biome çš„æ— é™ç”Ÿæˆï¼‰
- å¤–éƒ¨å‡½æ•°å¼æ¸²æŸ“ï¼ˆé OOP çš„ draw æ–¹æ³•ï¼‰
- wordProgress ä»…è®°å½•æ”¶é›†æ¬¡æ•°ï¼Œä¸è¿½è¸ªç­”é¢˜æ•°æ®

### ä¼˜åŒ–ç­–ç•¥ï¼ˆ4+1 æ ¸å¿ƒæ”¹åŠ¨ï¼‰

| ä¼˜å…ˆçº§ | æ”¹åŠ¨ | æŠ•å…¥äº§å‡ºæ¯” | æŠ€æœ¯éš¾åº¦ | é¢„æœŸæ•ˆæœ |
|--------|------|-----------|---------|---------|
| â­â­â­â­â­ | **å‰ç½®ï¼šæ‰©å±•ç­”é¢˜æ•°æ®ç»“æ„** | æé«˜ | ä½ | æ‰€æœ‰åç»­æ”¹åŠ¨çš„åŸºç¡€ |
| â­â­â­â­â­ | **å®ç®±ç»‘å®šå­¦ä¹ ** | æé«˜ | ä¸­ | æ¶ˆé™¤è´Ÿé¢ä½“éªŒï¼Œå¼ºåŒ–å­¦ä¹ åŠ¨æœº |
| â­â­â­â­â­ | **ç¯å¢ƒå•è¯æ ‡ç­¾** | æé«˜ | ä½ | çº¯å¢é‡ï¼Œæœ€è‡ªç„¶çš„è¢«åŠ¨å­¦ä¹  |
| â­â­â­â­ | **Biome åˆ‡æ¢å¤ä¹ ** | é«˜ | ä¸­ | å·©å›ºè®°å¿†ï¼Œåˆ©ç”¨è‡ªç„¶åœé¡¿ç‚¹ |
| â­â­â­â­ | **æ‰©å±•ä¸ªäººèµ„æ–™é¢æ¿** | é«˜ | ä½ | å¯è§†åŒ–æˆé•¿ï¼Œæå‡é•¿æœŸåŠ¨åŠ› |

---

## äºŒã€æŠ€æœ¯æ¶æ„ä¿®æ­£ï¼ˆå…³é”®å‘ç°ï¼‰

### 2.1 æŒ‘æˆ˜ç³»ç»Ÿæ¶æ„

**å®é™…ä»£ç æ¨¡å¼**ï¼ˆéå›è°ƒæ¨¡å¼ï¼‰ï¼š
```javascript
// å…¨å±€çŠ¶æ€å˜é‡
let currentLearningChallenge = null;
let challengeOrigin = null;  // å¯ä»¥æ˜¯ WordGate å®ä¾‹ã€Chest å®ä¾‹ç­‰

// è§¦å‘æµç¨‹
startLearningChallenge(wordObj, type, origin) {
    currentLearningChallenge = { wordObj, type, ... };
    challengeOrigin = origin;
    paused = true;
}

// å®Œæˆæµç¨‹
completeLearningChallenge(correct) {
    // é€šè¿‡æ£€æŸ¥ challengeOrigin ç±»å‹æ¥æ‰§è¡Œä¸åŒé€»è¾‘
    if (challengeOrigin instanceof WordGate) { ... }
    if (challengeOrigin instanceof Chest) { ... }  // éœ€è¦æ–°å¢
    challengeOrigin = null;
    paused = false;
}
```

**å…³é”®å½±å“**ï¼š
- å®ç®±ç»‘å®šå­¦ä¹ éœ€è¦åœ¨ `completeLearningChallenge` ä¸­æ–°å¢ Chest ç±»å‹åˆ†æ”¯
- æ— æ³•ä¼ å…¥å›è°ƒå‡½æ•°ï¼Œå¿…é¡»ä¾èµ–å…¨å±€çŠ¶æ€åˆ¤æ–­

### 2.2 å…³å¡ç³»ç»Ÿæ¶æ„

**å®é™…ä»£ç æ¨¡å¼**ï¼ˆæ— ç¦»æ•£å…³å¡ï¼‰ï¼š
```javascript
// nextLevel() å·²åºŸå¼ƒ
// æ³¨é‡Šï¼š"Deprecated: scenes are controlled by biomes now."

// å®é™…æœºåˆ¶ï¼šæ— é™ç”Ÿæˆçš„è¿ç»­åœ°å›¾ï¼Œé åˆ†æ•°é©±åŠ¨ biome åˆ‡æ¢
function updateCurrentBiome() {
    if (score >= nextBiome.minScore) {
        currentBiome = nextBiome;
        showToast(`ğŸŒ è¿›å…¥${nextBiome.name}ç¾¤ç³»`);
        // è¿™é‡Œæ˜¯è‡ªç„¶çš„å¤ä¹ è§¦å‘ç‚¹
    }
}
```

**å…³é”®å½±å“**ï¼š
- å¤ä¹ ç³»ç»Ÿæ— æ³•ä½¿ç”¨"æ¯3å…³è§¦å‘"
- å¿…é¡»æ”¹ä¸ºï¼šæŒ‰åˆ†æ•°é˜ˆå€¼ / biome åˆ‡æ¢ / æ”¶é›†æ•°é‡è§¦å‘

### 2.3 æ•°æ®ç»“æ„ç¼ºé™·

**ç°æœ‰ wordProgress ç»“æ„**ï¼ˆä»…è®°å½•æ”¶é›†ï¼‰ï¼š
```javascript
progress.vocab = {
    "kindergarten": {
        unique: { "apple": 3, "cat": 2 },  // ä»…æ”¶é›†æ¬¡æ•°
        uniqueCount: 2,
        total: 17,
        completed: false
    }
}
// ç¼ºå°‘ï¼šcorrectCountã€wrongCountã€lastSeenã€accuracy
```

**å¿…é¡»æ‰©å±•çš„æ–°ç»“æ„**ï¼š
```javascript
progress.challengeStats = {
    "apple": {
        correct: 5,      // ç­”å¯¹æ¬¡æ•°
        wrong: 2,        // ç­”é”™æ¬¡æ•°
        lastSeen: 1707900000000,  // æœ€åç­”é¢˜æ—¶é—´
    },
    "cat": {
        correct: 3,
        wrong: 0,
        lastSeen: 1707895000000
    }
}
```

### 2.4 æ¸²æŸ“ç³»ç»Ÿæ¶æ„

**å®é™…ä»£ç æ¨¡å¼**ï¼ˆå¤–éƒ¨å‡½æ•°å¼æ¸²æŸ“ï¼‰ï¼š
```javascript
// ä¸æ˜¯ enemy.draw(ctx)ï¼Œè€Œæ˜¯å¤–éƒ¨å‡½æ•°
function drawEnemy(enemy) {
    switch (enemy.type) {
        case "zombie": drawZombie(enemy); break;
        case "spider": drawSpider(enemy); break;
    }
}
```

**å…³é”®å½±å“**ï¼š
- ç¯å¢ƒæ ‡ç­¾éœ€è¦åœ¨ `drawEnemy()` ç­‰å¤–éƒ¨æ¸²æŸ“å‡½æ•°æœ«å°¾ç»Ÿä¸€æ·»åŠ 
- ä¸èƒ½ä¿®æ”¹å®ä½“ç±»çš„ draw() æ–¹æ³•ï¼ˆå› ä¸ºä¸å­˜åœ¨ï¼‰

---

## ä¸‰ã€è¯¦ç»†å®æ–½æ–¹æ¡ˆ

### 3.0 å‰ç½®æ¡ä»¶ï¼šæ‰©å±•ç­”é¢˜æ•°æ®ç»“æ„ï¼ˆå¿…é¡»æœ€å…ˆå®Œæˆï¼‰

> **æ‰€æœ‰åç»­æ”¹åŠ¨éƒ½ä¾èµ–è¿™ä¸ªæ•°æ®ç»“æ„**ï¼Œå¿…é¡»ç¬¬ä¸€ä¸ªå®æ–½

#### Step 0.1 â€” æ–°å¢ challengeStats å­˜å‚¨ç»“æ„

**æ–‡ä»¶**ï¼š`src/modules/09-vocab.js`

åœ¨ `normalizeProgress()` ä¸­æ‰©å±• progress ç»“æ„ï¼š

```javascript
function normalizeProgress(p) {
    p = p || {};
    p.vocab = p.vocab || {};
    
    // æ–°å¢ï¼šç­”é¢˜ç»Ÿè®¡æ•°æ®
    p.challengeStats = p.challengeStats || {};
    // ç»“æ„ï¼šp.challengeStats["apple"] = { correct: 3, wrong: 1, lastSeen: 1707900000000 }
    
    return p;
}
```

#### Step 0.2 â€” åœ¨ completeLearningChallenge ä¸­è®°å½•ç­”é¢˜ç»“æœ

**æ–‡ä»¶**ï¼š`src/modules/12-challenges.js`

åœ¨ `completeLearningChallenge(correct)` å‡½æ•°ä¸­ï¼Œ`hideLearningChallenge()` ä¹‹åã€å¥–æƒ©é€»è¾‘ä¹‹å‰æ’å…¥ï¼š

```javascript
function completeLearningChallenge(correct) {
    hideLearningChallenge();
    
    // === æ–°å¢ï¼šè®°å½•ç­”é¢˜ç»Ÿè®¡ ===
    const wordEn = currentLearningChallenge?.wordObj?.en;
    if (wordEn) {
        if (!progress.challengeStats) progress.challengeStats = {};
        const stat = progress.challengeStats[wordEn] || { 
            correct: 0, 
            wrong: 0, 
            lastSeen: 0 
        };
        
        if (correct) {
            stat.correct++;
        } else {
            stat.wrong++;
        }
        stat.lastSeen = Date.now();
        
        progress.challengeStats[wordEn] = stat;
        saveProgress();
    }
    // === è®°å½•ç»“æŸ ===
    
    // åŸæœ‰çš„ç­”å¯¹ç­”é”™é€»è¾‘...
    if (correct) {
        addScore(20);
        // ...
    } else {
        addScore(-8);
        // ...
    }
}
```

#### Step 0.3 â€” æä¾›ç»Ÿè®¡æŸ¥è¯¢è¾…åŠ©å‡½æ•°

**æ–‡ä»¶**ï¼š`src/modules/09-vocab.js`ï¼ˆæœ«å°¾è¿½åŠ ï¼‰

```javascript
/**
 * è·å–ç­”é¢˜ç»Ÿè®¡æ•°æ®
 * @returns {Object} ç»Ÿè®¡å¯¹è±¡
 */
function getChallengeStats() {
    const stats = progress.challengeStats || {};
    const words = Object.keys(stats);
    
    let totalCorrect = 0, totalWrong = 0;
    words.forEach(w => {
        totalCorrect += stats[w].correct || 0;
        totalWrong += stats[w].wrong || 0;
    });
    
    const total = totalCorrect + totalWrong;
    
    return {
        wordCount: words.length,           // ç­”é¢˜æ¶‰åŠå•è¯æ•°
        totalCorrect: totalCorrect,        // æ€»ç­”å¯¹æ¬¡æ•°
        totalWrong: totalWrong,            // æ€»ç­”é”™æ¬¡æ•°
        accuracy: total > 0 ? Math.round(totalCorrect / total * 100) : 0,  // æ­£ç¡®ç‡
        details: stats                     // è¯¦ç»†æ•°æ®
    };
}
```

#### éªŒè¯æ–¹å¼

1. æ‰“å¼€æ¸¸æˆï¼Œæ”¶é›†å•è¯è§¦å‘ Challenge
2. ç­”é¢˜ååœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œï¼š
   ```javascript
   JSON.parse(localStorage.getItem("mmwg:progress")).challengeStats
   ```
3. ç¡®è®¤æœ‰å¯¹åº”å•è¯çš„ correct/wrong/lastSeen æ•°æ®

---

### 3.1 å®ç®±ç»‘å®šå­¦ä¹ ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰

> **ç›®æ ‡**ï¼šå°†éšæœºå¼¹å‡ºçš„ Challenge æ”¹ä¸ºåœ¨å®ç®±äº¤äº’æ—¶è§¦å‘ï¼Œè§£å†³"æ‰“æ–­å¿ƒæµ"é—®é¢˜

#### Step 1.1 â€” ä¿®æ”¹ handleInteraction() æ‹¦æˆªå®ç®±å¼€å¯

**æ–‡ä»¶**ï¼š`src/modules/13-game-loop.js`ï¼ˆç¬¬733-753è¡Œï¼‰

å°† `handleInteraction()` ä¸­çš„ `nearestChest.open()` æ”¹ä¸ºå…ˆè§¦å‘ç­”é¢˜ï¼š

```javascript
// === åŸä»£ç ï¼ˆç¬¬749-750è¡Œï¼‰===
} else {
    nearestChest.open();
}

// === æ”¹ä¸º ===
} else {
    // å®ç®±å­¦ä¹ æ¨¡å¼ï¼šå¼€ç®±å‰å…ˆç­”é¢˜
    if (settings.learningMode && 
        settings.chestLearningEnabled && 
        !currentLearningChallenge) {
        
        // ä»å½“å‰è¯åº“éšæœºå–ä¸€ä¸ªå•è¯
        const wordObj = pickNextWord();
        
        if (wordObj) {
            // è§¦å‘ Challengeï¼Œorigin ä¼ å…¥ chest å®ä¾‹
            startLearningChallenge(wordObj, null, nearestChest);
        } else {
            // æ— å¯ç”¨å•è¯æ—¶ç›´æ¥å¼€ç®±
            nearestChest.open();
        }
    } else {
        // å­¦ä¹ æ¨¡å¼å…³é—­æ—¶ç›´æ¥å¼€ç®±
        nearestChest.open();
    }
}
```

éœ€è¦ç¡®è®¤ `pickNextWord()` å‡½æ•°æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œæ–°å¢ä»¥ä¸‹å‡½æ•°ï¼š

```javascript
/**
 * ä»å½“å‰è¯åº“éšæœºå–ä¸€ä¸ªå•è¯
 * @returns {Object|null} å•è¯å¯¹è±¡æˆ–null
 */
function pickNextWord() {
    if (!wordDatabase || !wordDatabase.length) return null;
    
    // ä»å·²åŠ è½½çš„ wordDatabase ä¸­éšæœºå–ä¸€ä¸ª
    const idx = Math.floor(Math.random() * wordDatabase.length);
    return wordDatabase[idx];
}
```

#### Step 1.2 â€” ä¿®æ”¹ completeLearningChallenge() å¤„ç†å®ç®±æ¥æº

**æ–‡ä»¶**ï¼š`src/modules/12-challenges.js`ï¼ˆç¬¬284-309è¡Œï¼‰

åœ¨ `completeLearningChallenge(correct)` ä¸­ï¼Œç°æœ‰çš„ `challengeOrigin instanceof WordGate` åˆ†æ”¯ä¹‹åï¼Œæ–°å¢ Chest åˆ†æ”¯ï¼š

```javascript
function completeLearningChallenge(correct) {
    hideLearningChallenge();
    
    // è®°å½•ç­”é¢˜ç»Ÿè®¡ï¼ˆå‰ç½®æ¡ä»¶å·²å®Œæˆï¼‰
    // ...
    
    if (correct) {
        addScore(20);
        inventory.diamond = (inventory.diamond || 0) + 1;
        updateInventoryUI();
        showToast(`âœ… ç­”å¯¹äº†ï¼+20åˆ† +1ğŸ’`, 1500);
        
        // === ç°æœ‰ä»£ç ï¼šWordGate åˆ†æ”¯ ===
        if (challengeOrigin && challengeOrigin instanceof WordGate) {
            challengeOrigin.locked = false;
            challengeOrigin.remove = true;
            showToast("ğŸ’  è¯è¯­é—¸é—¨å·²è§£é”ï¼");
        }
        
        // === æ–°å¢ï¼šChest åˆ†æ”¯ ===
        if (challengeOrigin && challengeOrigin instanceof Chest) {
            // ç­”å¯¹ï¼šæ ‡è®°æå‡ç¨€æœ‰åº¦
            challengeOrigin._rarityBoost = true;
            challengeOrigin.open();
            showToast("ğŸ ç­”å¯¹äº†ï¼å®ç®±å¥–åŠ±å‡çº§ï¼", 2000);
        }
        
    } else {
        addScore(-8);
        showToast(`âŒ ç­”é”™äº†... -8åˆ†`, 1500);
        
        // === ç°æœ‰ä»£ç ï¼šWordGate åˆ†æ”¯ ===
        if (challengeOrigin && challengeOrigin instanceof WordGate) {
            challengeOrigin.cooldown = 180;
        }
        
        // === æ–°å¢ï¼šChest åˆ†æ”¯ ===
        if (challengeOrigin && challengeOrigin instanceof Chest) {
            // ç­”é”™ä¹Ÿå¼€ç®±ï¼Œåªæ˜¯ä¸æå‡ç¨€æœ‰åº¦
            challengeOrigin.open();
            showToast("ğŸ’¼ ç­”é”™äº†ï¼Œä½†è¿˜æ˜¯å¯ä»¥å¼€ç®±", 2000);
        }
    }
    
    // æ¢å¤æ¸¸æˆçŠ¶æ€
    paused = challengePausedBefore;
    currentLearningChallenge = null;
    challengeOrigin = null;
}
```

#### Step 1.3 â€” ä¿®æ”¹ Chest.open() æ”¯æŒç¨€æœ‰åº¦æå‡

**æ–‡ä»¶**ï¼š`src/modules/15-entities-base.js`ï¼ˆç¬¬75-128è¡Œï¼‰

åœ¨ `open()` æ–¹æ³•ä¸­ï¼Œ`pickChestRarity()` ä¹‹ååŠ å…¥ç¨€æœ‰åº¦æå‡é€»è¾‘ï¼š

```javascript
open() {
    if (this.opened) return;
    this.opened = true;
    
    const diff = getCurrentDifficulty();
    const lootCfg = getPlayerLootConfig();
    
    // === åŸä»£ç  ===
    let rarity = pickChestRarity(lootCfg.chestRarities, diff.chestRareBoost);
    
    // === æ–°å¢ï¼šç­”å¯¹åæå‡ç¨€æœ‰åº¦ ===
    if (this._rarityBoost) {
        const levels = ['common', 'rare', 'epic', 'legendary'];
        const idx = levels.indexOf(rarity);
        
        if (idx >= 0 && idx < levels.length - 1) {
            rarity = levels[idx + 1];  // æå‡ä¸€çº§
            console.log(`å®ç®±ç¨€æœ‰åº¦æå‡ï¼š${levels[idx]} â†’ ${rarity}`);
        }
        
        this._rarityBoost = false;  // æ¸…é™¤æ ‡è®°
    }
    
    // åŸæœ‰çš„æ‰è½é€»è¾‘...
    const dropList = rollChestRewards(rarity, lootCfg, diff);
    // ...
}
```

#### Step 1.4 â€” é™ä½éšæœº Challenge è§¦å‘é¢‘ç‡

**æ–‡ä»¶**ï¼š`src/modules/12-challenges.js`

åœ¨ `maybeTriggerLearningChallenge()` ä¸­ï¼ˆç¬¬188è¡Œï¼‰ï¼Œå½“å®ç®±å­¦ä¹ å¼€å¯æ—¶ï¼Œé™ä½æˆ–å…³é—­éšæœºè§¦å‘ï¼š

```javascript
function maybeTriggerLearningChallenge(wordObj) {
    if (!wordObj || !wordObj.en) return;
    
    registerCollectedWord(wordObj);
    
    // === æ–°å¢ï¼šå¦‚æœå®ç®±å­¦ä¹ å·²å¼€å¯ï¼Œä¸å†éšæœºå¼¹å‡º Challenge ===
    // é¿å…åŒé‡æ‰“æ–­å¿ƒæµï¼Œä¿ç•™ WordGate è§¦å‘ä¸å—å½±å“
    if (settings.chestLearningEnabled) {
        return;
    }
    
    if (!shouldTriggerLearningChallenge(wordObj)) return;
    startLearningChallenge(wordObj);
}
```

#### Step 1.5 â€” æ–°å¢é…ç½®é¡¹

**æ–‡ä»¶**ï¼š`src/defaults.js` æˆ– `src/modules/01-config.js`

```javascript
const defaultSettings = {
    // ç°æœ‰é…ç½®...
    
    // å®ç®±å­¦ä¹ 
    chestLearningEnabled: true,    // å®ç®±æ˜¯å¦å…³è”å­¦ä¹ ç­”é¢˜
};
```

åœ¨ `normalizeSettings()` ä¸­åŠ å…¥ï¼š

```javascript
function normalizeSettings(s) {
    const merged = { ...defaultSettings, ...s };
    
    // ç°æœ‰çš„ç±»å‹æ£€æŸ¥...
    
    if (typeof merged.chestLearningEnabled !== "boolean") {
        merged.chestLearningEnabled = defaultSettings.chestLearningEnabled ?? true;
    }
    
    return merged;
}
```

#### Step 1.6 â€” è®¾ç½®é¢æ¿å¢åŠ å¼€å…³ï¼ˆå¯é€‰ï¼‰

**æ–‡ä»¶**ï¼š`Game.html` è®¾ç½®é¢æ¿åŒºåŸŸ

```html
<label>
    <input type="checkbox" id="opt-chest-learning"> 
    å®ç®±å­¦ä¹ æ¨¡å¼ï¼ˆå¼€ç®±å‰ç­”é¢˜ï¼‰
</label>
```

**æ–‡ä»¶**ï¼š`src/modules/16-events.js` è®¾ç½®è¯»å†™å¤„

```javascript
// è¯»å–è®¾ç½®
const optChestLearning = document.getElementById("opt-chest-learning");
if (optChestLearning) {
    optChestLearning.checked = !!settings.chestLearningEnabled;
}

// ä¿å­˜è®¾ç½®
if (optChestLearning) {
    settings.chestLearningEnabled = !!optChestLearning.checked;
}
```

#### éªŒè¯æ–¹å¼

1. å¼€å¯ learningModeï¼Œé è¿‘å®ç®±æŒ‰äº¤äº’é”®
2. åº”å¼¹å‡º Challenge ç­”é¢˜ç•Œé¢ï¼ˆè€Œéç›´æ¥å¼€ç®±ï¼‰
3. ç­”å¯¹ â†’ å¼€ç®±ï¼ŒToast æ˜¾ç¤ºæ›´é«˜ç¨€æœ‰åº¦ï¼Œæ‰è½æ›´å¥½
4. ç­”é”™ â†’ å¼€ç®±ï¼Œç¨€æœ‰åº¦ä¸å˜ï¼Œæ‰è½æ­£å¸¸
5. æ”¶é›†å•è¯æ—¶ä¸å†éšæœºå¼¹å‡º Challenge
6. è®¾ç½®ä¸­å…³é—­ chestLearningEnabled â†’ å®ç®±ç›´æ¥å¼€å¯

---

### 3.2 ç¯å¢ƒå•è¯æ ‡ç­¾ï¼ˆçº¯å¢é‡ï¼Œç‹¬ç«‹æ€§å¼ºï¼‰

> **ç›®æ ‡**ï¼šåœ¨æ•Œäºº/ç‰©å“ä¸Šæ–¹æ˜¾ç¤ºè‹±æ–‡åï¼Œå®ç°é›¶å‹åŠ›çš„è¢«åŠ¨æµ¸å…¥å­¦ä¹ 

#### Step 2.1 â€” å®šä¹‰å®ä½“è‹±æ–‡åæ˜ å°„è¡¨

**æ–‡ä»¶**ï¼š`src/modules/01-config.js` æˆ–æ–°å»º `src/modules/entity-names.js`

```javascript
/**
 * æ¸¸æˆå®ä½“è‹±æ–‡åæ˜ å°„è¡¨
 */
const ENTITY_NAMES = {
    // æ•Œäºº
    zombie:          { en: "ZOMBIE",          zh: "åƒµå°¸" },
    spider:          { en: "SPIDER",          zh: "èœ˜è››" },
    creeper:         { en: "CREEPER",         zh: "çˆ¬è¡Œè€…" },
    skeleton:        { en: "SKELETON",        zh: "éª·é«…" },
    enderman:        { en: "ENDERMAN",        zh: "æœ«å½±äºº" },
    slime:           { en: "SLIME",           zh: "å²è±å§†" },
    
    // BOSS
    ender_dragon:    { en: "ENDER DRAGON",    zh: "æœ«å½±é¾™" },
    wither:          { en: "WITHER",          zh: "å‡‹é›¶" },
    ghast:           { en: "GHAST",           zh: "æ¶é­‚" },
    blaze:           { en: "BLAZE",           zh: "çƒˆç„°äºº" },
    wither_skeleton: { en: "WITHER SKELETON", zh: "å‡‹é›¶éª·é«…" },
    
    // å‹æ–¹
    iron_golem:      { en: "IRON GOLEM",      zh: "é“å‚€å„¡" },
    snow_golem:      { en: "SNOW GOLEM",      zh: "é›ªå‚€å„¡" },
    
    // ç‰©å“
    chest:           { en: "CHEST",           zh: "å®ç®±" },
    diamond:         { en: "DIAMOND",         zh: "é’»çŸ³" },
    iron:            { en: "IRON",            zh: "é“" },
    pumpkin:         { en: "PUMPKIN",         zh: "å—ç“œ" },
    stick:           { en: "STICK",           zh: "æœ¨æ£" },
    beef:            { en: "BEEF",            zh: "ç‰›è‚‰" },
    mutton:          { en: "MUTTON",          zh: "ç¾Šè‚‰" },
    
    // ç¯å¢ƒï¼ˆæ–°å¢ï¼‰
    ocean:           { en: "OCEAN",           zh: "æµ·æ´‹" },
    nether:          { en: "NETHER",          zh: "ä¸‹ç•Œ" },
    lava:            { en: "LAVA",            zh: "å²©æµ†" },
    seaweed:         { en: "SEAWEED",         zh: "æµ·è‰" },
    mushroom:        { en: "MUSHROOM",        zh: "è˜‘è‡" }
};
```

å¦‚æœæ–°å»ºäº†ç‹¬ç«‹æ–‡ä»¶ï¼Œéœ€è¦åœ¨ `Game.html` ä¸­å¼•å…¥ï¼š

```html
<script src="src/modules/entity-names.js"></script>
```

#### Step 2.2 â€” æ–°å¢ drawEntityLabel() é€šç”¨å‡½æ•°

**æ–‡ä»¶**ï¼š`src/modules/14-renderer-entities.js`ï¼ˆæ–‡ä»¶é¡¶éƒ¨è¿½åŠ ï¼‰

```javascript
/**
 * ç»˜åˆ¶å®ä½“ä¸Šæ–¹çš„è‹±æ–‡åæ ‡ç­¾
 * @param {number} x - å®ä½“Xåæ ‡
 * @param {number} y - å®ä½“Yåæ ‡
 * @param {number} width - å®ä½“å®½åº¦
 * @param {string} type - å®ä½“ç±»å‹ï¼ˆå¦‚ "zombie", "chest"ï¼‰
 */
function drawEntityLabel(x, y, width, type) {
    // æ£€æŸ¥é…ç½®å¼€å…³
    if (!settings.showEnvironmentWords) return;
    
    // æŸ¥æ‰¾æ˜ å°„è¡¨
    const entry = ENTITY_NAMES[type];
    if (!entry) return;
    
    const centerX = x + width / 2;
    const labelY = y - 14;  // åœ¨å®ä½“ä¸Šæ–¹14åƒç´ 
    
    ctx.save();
    ctx.font = "bold 11px Arial";
    ctx.textAlign = "center";
    
    // é»‘è‰²æè¾¹ï¼ˆç¡®ä¿åœ¨ä»»ä½•èƒŒæ™¯ä¸‹å¯è§ï¼‰
    ctx.strokeStyle = "rgba(0,0,0,0.7)";
    ctx.lineWidth = 3;
    ctx.strokeText(entry.en, centerX, labelY);
    
    // ç™½è‰²æ–‡å­—
    ctx.fillStyle = "rgba(255,255,255,0.9)";
    ctx.fillText(entry.en, centerX, labelY);
    
    ctx.restore();
}
```

#### Step 2.3 â€” åœ¨ drawEnemy() æœ«å°¾è°ƒç”¨

**æ–‡ä»¶**ï¼š`src/modules/14-renderer-entities.js`ï¼ˆç¬¬69-102è¡Œï¼‰

åœ¨ `drawEnemy()` å‡½æ•°æœ«å°¾ï¼Œè¡€æ¡ç»˜åˆ¶ä¹‹åè¿½åŠ ï¼š

```javascript
function drawEnemy(enemy) {
    // åŸæœ‰çš„æ•Œäººç»˜åˆ¶ä»£ç ...
    
    // ç»˜åˆ¶è¡€æ¡ï¼ˆå¦‚æœè¡€é‡ä¸æ»¡ï¼‰
    if (enemy.hp < enemy.maxHp) {
        drawHealthBar(enemy.x, enemy.y - 8, enemy.width, enemy.hp, enemy.maxHp);
    }
    
    // === æ–°å¢ï¼šç»˜åˆ¶è‹±æ–‡åæ ‡ç­¾ ===
    // å¦‚æœæœ‰è¡€æ¡ï¼Œæ ‡ç­¾ä½ç½®ä¸Šç§»é¿å…é‡å 
    const labelOffset = enemy.hp < enemy.maxHp ? 16 : 0;
    drawEntityLabel(enemy.x, enemy.y - labelOffset, enemy.width, enemy.type);
}
```

#### Step 2.4 â€” åœ¨ drawGolem() æœ«å°¾è°ƒç”¨

**æ–‡ä»¶**ï¼š`src/modules/14-renderer-entities.js`ï¼ˆç¬¬255-277è¡Œï¼‰

åœ¨ `drawGolem()` æœ«å°¾è¿½åŠ ï¼š

```javascript
function drawGolem(golem) {
    // åŸæœ‰çš„å‚€å„¡ç»˜åˆ¶ä»£ç ...
    
    // ç»˜åˆ¶è¡€æ¡
    drawHealthBar(x, y - 8, golem.width, golem.hp, golem.maxHp);
    
    // === æ–°å¢ï¼šç»˜åˆ¶è‹±æ–‡åæ ‡ç­¾ ===
    const golemType = golem.type === "iron" ? "iron_golem" : "snow_golem";
    drawEntityLabel(x, y - 16, golem.width, golemType);
}
```

#### Step 2.5 â€” åœ¨å®ç®±æ¸²æŸ“å¤„è°ƒç”¨

**æ–‡ä»¶**ï¼š`src/modules/14-renderer-main.js`ï¼ˆç¬¬32è¡Œé™„è¿‘ï¼‰

```javascript
// === åŸä»£ç  ===
chests.forEach(c => drawChest(c.x, c.y, c.opened));

// === æ”¹ä¸º ===
chests.forEach(c => {
    drawChest(c.x, c.y, c.opened);
    
    // æœªå¼€å¯çš„å®ç®±æ˜¾ç¤ºè‹±æ–‡å
    if (!c.opened) {
        const width = c.width || blockSize * 0.8;
        drawEntityLabel(c.x, c.y, width, "chest");
    }
});
```

#### Step 2.6 â€” æ–°å¢é…ç½®é¡¹

**æ–‡ä»¶**ï¼š`src/defaults.js`

```javascript
const defaultSettings = {
    // ç°æœ‰é…ç½®...
    
    // ç¯å¢ƒå•è¯æ ‡ç­¾
    showEnvironmentWords: true,      // æ˜¯å¦æ˜¾ç¤ºç¯å¢ƒå•è¯æ ‡ç­¾
};
```

åœ¨ `normalizeSettings()` ä¸­åŠ å…¥ï¼š

```javascript
if (typeof merged.showEnvironmentWords !== "boolean") {
    merged.showEnvironmentWords = defaultSettings.showEnvironmentWords ?? true;
}
```

#### Step 2.7 â€” è®¾ç½®é¢æ¿å¢åŠ å¼€å…³

**æ–‡ä»¶**ï¼š`Game.html` è®¾ç½®é¢æ¿åŒºåŸŸ

```html
<label>
    <input type="checkbox" id="opt-env-words"> 
    æ˜¾ç¤ºç¯å¢ƒå•è¯æ ‡ç­¾
</label>
```

**æ–‡ä»¶**ï¼š`src/modules/16-events.js` è®¾ç½®è¯»å†™å¤„

```javascript
// è¯»å–
const optEnvWords = document.getElementById("opt-env-words");
if (optEnvWords) {
    optEnvWords.checked = !!settings.showEnvironmentWords;
}

// ä¿å­˜
if (optEnvWords) {
    settings.showEnvironmentWords = !!optEnvWords.checked;
}
```

#### éªŒè¯æ–¹å¼

1. å¼€å§‹æ¸¸æˆï¼Œé‡åˆ°åƒµå°¸ â†’ å¤´ä¸Šæ˜¾ç¤º "ZOMBIE"
2. é‡åˆ°èœ˜è›› â†’ æ˜¾ç¤º "SPIDER"
3. å®ç®±æœªå¼€å¯æ—¶æ˜¾ç¤º "CHEST"ï¼Œå¼€å¯åä¸æ˜¾ç¤º
4. è®¾ç½®ä¸­å…³é—­å¼€å…³ â†’ æ ‡ç­¾æ¶ˆå¤±
5. æ ‡ç­¾ä¸é®æŒ¡è¡€æ¡ï¼Œä½ç½®åˆç†

---

### 3.3 Biome åˆ‡æ¢æ—¶è§¦å‘å¤ä¹ 

> **ç›®æ ‡**ï¼šåˆ©ç”¨ biome åˆ‡æ¢è¿™ä¸ªè‡ªç„¶åœé¡¿ç‚¹ï¼Œè§¦å‘å¿«é€Ÿå¤ä¹ ï¼Œæ›¿ä»£ä¸å¯è¡Œçš„"æ¯3å…³å¤ä¹ "

#### Step 3.1 â€” æ–°å¢ getWordsForReview() å‡½æ•°

**æ–‡ä»¶**ï¼š`src/modules/09-vocab.js`ï¼ˆæœ«å°¾è¿½åŠ ï¼‰

```javascript
/**
 * è·å–éœ€è¦å¤ä¹ çš„å•è¯åˆ—è¡¨ï¼ˆåŸºäºé—´éš”é‡å¤ç®—æ³•ï¼‰
 * @param {number} count - éœ€è¦å¤ä¹ çš„å•è¯æ•°é‡ï¼ˆé»˜è®¤3ä¸ªï¼‰
 * @returns {Array} å•è¯å¯¹è±¡æ•°ç»„
 */
function getWordsForReview(count) {
    count = count || 3;
    const stats = progress.challengeStats || {};
    const now = Date.now();
    const candidates = [];
    
    // ä»ç­”é¢˜è®°å½•ä¸­æ‰¾å‡º"è¯¥å¤ä¹ "çš„å•è¯
    for (const word in stats) {
        const s = stats[word];
        const total = (s.correct || 0) + (s.wrong || 0);
        if (total === 0) continue;
        
        // é—´éš”ç­–ç•¥ï¼šç­”å¯¹è¶Šå¤šï¼Œå¤ä¹ é—´éš”è¶Šé•¿
        const level = Math.min(s.correct || 0, 5);
        const intervals = [
            0,           // level 0: ç«‹å³
            60000,       // level 1: 1åˆ†é’Ÿ
            300000,      // level 2: 5åˆ†é’Ÿ
            900000,      // level 3: 15åˆ†é’Ÿ
            3600000,     // level 4: 1å°æ—¶
            86400000     // level 5: 1å¤©
        ];
        
        const nextReview = (s.lastSeen || 0) + (intervals[level] || 0);
        
        if (now >= nextReview) {
            // è®¡ç®—ä¼˜å…ˆçº§ï¼šé”™è¯¯ç‡é«˜çš„ + ä¹…æœªå¤ä¹ çš„ä¼˜å…ˆ
            const errorRate = (s.wrong || 0) / total;
            const timeSince = now - (s.lastSeen || 0);
            
            candidates.push({
                word: word,
                priority: errorRate * 100 + timeSince / 60000  // å½’ä¸€åŒ–ä¼˜å…ˆçº§
            });
        }
    }
    
    // æŒ‰ä¼˜å…ˆçº§æ’åºï¼Œå–å‰Nä¸ª
    candidates.sort((a, b) => b.priority - a.priority);
    
    // è¿”å›å®Œæ•´çš„ wordObj
    return candidates.slice(0, count).map(c => {
        const found = wordDatabase.find(w => w.en === c.word);
        return found || { en: c.word, zh: stats[c.word]?.zh || "" };
    });
}
```

#### Step 3.2 â€” åœ¨ updateCurrentBiome() ä¸­è§¦å‘å¤ä¹ 

**æ–‡ä»¶**ï¼š`src/modules/06-biome.js`ï¼ˆç¬¬54-77è¡Œï¼‰

åœ¨ `updateCurrentBiome()` ä¸­ï¼Œbiome åˆ‡æ¢æˆåŠŸåï¼ˆ`showToast` ä¹‹åï¼‰ï¼Œæ’å…¥å¤ä¹ è§¦å‘ï¼š

```javascript
function updateCurrentBiome() {
    const nextBiome = determineNextBiome();
    
    if (!nextBiome || nextBiome.id === currentBiome.id) return;
    
    currentBiome = nextBiome;
    clearLevel();
    buildBiomeLevel();
    
    // === åŸä»£ç  ===
    showToast(`ğŸŒ è¿›å…¥${nextBiome.name}ç¾¤ç³»`);
    
    // === æ–°å¢ï¼šå»¶è¿Ÿè§¦å‘å¤ä¹  ===
    if (settings.reviewOnBiomeSwitch) {
        // å»¶è¿Ÿ1.5ç§’ï¼Œè®© biome åˆ‡æ¢åŠ¨ç”»å®Œæˆ
        setTimeout(() => maybeShowReview(), 1500);
    }
}
```

#### Step 3.3 â€” æ–°å¢å¤ä¹ æµç¨‹æ§åˆ¶å‡½æ•°

**æ–‡ä»¶**ï¼š`src/modules/12-challenges.js`ï¼ˆæœ«å°¾è¿½åŠ ï¼‰

```javascript
// å¤ä¹ ç³»ç»Ÿå…¨å±€çŠ¶æ€
let reviewActive = false;
let reviewWords = [];
let reviewIndex = 0;
let reviewResults = [];

/**
 * æ£€æŸ¥å¹¶å¯åŠ¨å¤ä¹ æµç¨‹
 */
function maybeShowReview() {
    // å®‰å…¨æ£€æŸ¥ï¼šä¸ä¸å…¶ä»–ç³»ç»Ÿå†²çª
    if (reviewActive || currentLearningChallenge || paused) return;
    
    // è·å–éœ€è¦å¤ä¹ çš„å•è¯
    const words = getWordsForReview(3);
    if (words.length === 0) return;
    
    // åˆå§‹åŒ–å¤ä¹ çŠ¶æ€
    reviewActive = true;
    reviewWords = words;
    reviewIndex = 0;
    reviewResults = [];
    paused = true;
    
    showToast("ğŸ“š å¿«é€Ÿå¤ä¹ ï¼", 1000);
    setTimeout(() => showReviewWord(), 500);
}

/**
 * æ˜¾ç¤ºå½“å‰å¤ä¹ å•è¯
 */
function showReviewWord() {
    if (reviewIndex >= reviewWords.length) {
        finishReview();
        return;
    }
    
    const wordObj = reviewWords[reviewIndex];
    
    // å¤ç”¨ç°æœ‰çš„ Challenge ç³»ç»Ÿæ¥æ˜¾ç¤ºé¢˜ç›®
    // origin ä¼ å…¥ç‰¹æ®Šæ ‡è®°å¯¹è±¡
    startLearningChallenge(wordObj, "translate", { 
        _isReview: true, 
        _reviewIndex: reviewIndex 
    });
}

/**
 * å®Œæˆå¤ä¹ æµç¨‹ï¼Œæ˜¾ç¤ºç»“æœå’Œå¥–åŠ±
 */
function finishReview() {
    reviewActive = false;
    
    const correct = reviewResults.filter(r => r.correct).length;
    const total = reviewResults.length;
    
    // æ›´æ–°ç»Ÿè®¡ï¼ˆå·²åœ¨ completeLearningChallenge ä¸­è®°å½•ï¼‰
    
    // è®¡ç®—å¥–åŠ±
    addScore(correct * 30);
    
    if (correct === total && total > 0) {
        // å…¨å¯¹å¥–åŠ±
        inventory.diamond = (inventory.diamond || 0) + 1;
        updateInventoryUI();
        showToast(`ğŸ“š å¤ä¹ å®Œæˆï¼å…¨å¯¹ï¼+${correct * 30}åˆ† +1ğŸ’`, 2500);
    } else {
        showToast(`ğŸ“š å¤ä¹ å®Œæˆï¼${correct}/${total} +${correct * 30}åˆ†`, 2000);
    }
    
    // æ¢å¤æ¸¸æˆçŠ¶æ€
    paused = false;
}
```

#### Step 3.4 â€” ä¿®æ”¹ completeLearningChallenge() å¤„ç†å¤ä¹ æ¥æº

**æ–‡ä»¶**ï¼š`src/modules/12-challenges.js`

åœ¨ `completeLearningChallenge(correct)` ä¸­ï¼ŒChest åˆ†æ”¯ä¹‹åè¿½åŠ ï¼š

```javascript
function completeLearningChallenge(correct) {
    hideLearningChallenge();
    
    // è®°å½•ç­”é¢˜ç»Ÿè®¡ï¼ˆå‰ç½®æ¡ä»¶å·²å®Œæˆï¼‰
    const wordEn = currentLearningChallenge?.wordObj?.en;
    if (wordEn) {
        // ... è®°å½• challengeStats ...
    }
    
    // === æ–°å¢ï¼šå¤„ç†å¤ä¹ æ¥æºï¼ˆå¿…é¡»åœ¨ paused æ¢å¤ä¹‹å‰ï¼‰ ===
    if (challengeOrigin && challengeOrigin._isReview) {
        // è®°å½•å¤ä¹ ç»“æœ
        reviewResults.push({ 
            word: currentLearningChallenge.wordObj.en, 
            correct: correct 
        });
        
        // ç§»åˆ°ä¸‹ä¸€ä¸ªå•è¯
        reviewIndex++;
        
        // æ¸…ç†çŠ¶æ€
        currentLearningChallenge = null;
        challengeOrigin = null;
        
        // çŸ­æš‚å»¶è¿Ÿåæ˜¾ç¤ºä¸‹ä¸€ä¸ªï¼ˆä¸æ¢å¤ pausedï¼‰
        setTimeout(() => showReviewWord(), 600);
        
        return;  // æå‰è¿”å›ï¼Œä¸æ‰§è¡Œåé¢çš„é€»è¾‘
    }
    
    // å¤„ç†ç­”å¯¹ç­”é”™ï¼ˆWordGateã€Chest åˆ†æ”¯ï¼‰
    if (correct) {
        // ...
    } else {
        // ...
    }
    
    // æ¢å¤æ¸¸æˆçŠ¶æ€
    paused = challengePausedBefore;
    currentLearningChallenge = null;
    challengeOrigin = null;
}
```

**å…³é”®ç‚¹**ï¼šå¤ä¹ åˆ†æ”¯å¿…é¡»åœ¨ `paused = challengePausedBefore` ä¹‹å‰ returnï¼Œä¿æŒæ¸¸æˆæš‚åœç›´åˆ°å¤ä¹ å…¨éƒ¨å®Œæˆã€‚

#### Step 3.5 â€” æ–°å¢é…ç½®é¡¹

**æ–‡ä»¶**ï¼š`src/defaults.js`

```javascript
const defaultSettings = {
    // ç°æœ‰é…ç½®...
    
    // å¤ä¹ ç³»ç»Ÿ
    reviewOnBiomeSwitch: true,       // biome åˆ‡æ¢æ—¶æ˜¯å¦è§¦å‘å¤ä¹ 
};
```

åœ¨ `normalizeSettings()` ä¸­åŠ å…¥ï¼š

```javascript
if (typeof merged.reviewOnBiomeSwitch !== "boolean") {
    merged.reviewOnBiomeSwitch = defaultSettings.reviewOnBiomeSwitch ?? true;
}
```

#### éªŒè¯æ–¹å¼

1. ç©æ¸¸æˆï¼Œå…ˆç­”å‡ é“ Challenge ç§¯ç´¯ç­”é¢˜æ•°æ®
2. åˆ†æ•°è¾¾åˆ° biome åˆ‡æ¢é˜ˆå€¼ï¼ˆé»˜è®¤200åˆ†ï¼‰
3. åˆ‡æ¢ biome å 1.5 ç§’å¼¹å‡ºå¤ä¹ 
4. è¿ç»­3é“ç¿»è¯‘é¢˜ï¼Œç­”å®Œæ˜¾ç¤ºç»“æœå’Œå¥–åŠ±
5. å¦‚æœæ²¡æœ‰ç­”é¢˜è®°å½•ï¼ˆæ–°æ¸¸æˆï¼‰ï¼Œä¸å¼¹å‡ºå¤ä¹ 
6. å…¨å¯¹å¥–åŠ±ï¼š+90åˆ† +1ğŸ’

---

### 3.4 æ‰©å±•ä¸ªäººèµ„æ–™é¢æ¿ï¼ˆå¢åŠ ç­”é¢˜ç»Ÿè®¡å’Œå•è¯æœ¬ï¼‰

> **ç›®æ ‡**ï¼šåœ¨å·²æœ‰çš„ä¸ªäººèµ„æ–™é¢æ¿ä¸­å¢åŠ ç­”é¢˜ç»Ÿè®¡å’Œå•è¯æœ¬æŸ¥çœ‹åŠŸèƒ½

#### Step 4.1 â€” åœ¨ä¸ªäººèµ„æ–™é¢æ¿ä¸­æ˜¾ç¤ºç­”é¢˜æ­£ç¡®ç‡

**æ–‡ä»¶**ï¼š`src/modules/08-account.js`ï¼ˆ`showProfileModal()` å‡½æ•°ï¼‰

åœ¨ç°æœ‰çš„ç»Ÿè®¡æ˜¾ç¤ºä¹‹åè¿½åŠ ï¼š

```javascript
function showProfileModal() {
    // åŸæœ‰çš„æ˜¾ç¤ºé€»è¾‘...
    
    // æ¸¸æˆç»Ÿè®¡
    if (profileGamesEl) {
        profileGamesEl.innerText = currentAccount.stats?.gamesPlayed || 0;
    }
    
    // === æ–°å¢ï¼šç­”é¢˜ç»Ÿè®¡ ===
    const challengeStatsEl = document.getElementById("profile-challenge-stats");
    if (challengeStatsEl) {
        const cs = getChallengeStats();
        
        if (cs.totalCorrect + cs.totalWrong > 0) {
            challengeStatsEl.innerHTML = 
                `ç­”é¢˜ ${cs.totalCorrect + cs.totalWrong} æ¬¡ï¼Œ` +
                `æ­£ç¡®ç‡ <strong>${cs.accuracy}%</strong>ï¼Œ` +
                `æ¶‰åŠ ${cs.wordCount} ä¸ªå•è¯`;
        } else {
            challengeStatsEl.innerHTML = 'è¿˜æ²¡æœ‰ç­”é¢˜è®°å½•';
            challengeStatsEl.style.color = '#888';
        }
    }
    
    // æ˜¾ç¤ºæ¨¡æ€æ¡†
    profileModal.classList.add("visible");
    profileModal.setAttribute("aria-hidden", "false");
}
```

#### Step 4.2 â€” åœ¨ Game.html ä¸­æ·»åŠ å¯¹åº” DOM å…ƒç´ 

**æ–‡ä»¶**ï¼š`Game.html`ï¼ˆprofile-modal åŒºåŸŸï¼‰

åœ¨ç°æœ‰çš„ç»Ÿè®¡é¡¹ä¹‹åè¿½åŠ ï¼š

```html
<!-- ç°æœ‰ç»Ÿè®¡é¡¹ -->
<div class="profile-stat">
    <span class="profile-stat-label">ğŸ® æ¸¸æˆæ¬¡æ•°</span>
    <span class="profile-stat-value" id="profile-games">0</span>
</div>

<!-- æ–°å¢ï¼šç­”é¢˜ç»Ÿè®¡ -->
<div class="profile-stat">
    <span class="profile-stat-label">ğŸ“ ç­”é¢˜ç»Ÿè®¡</span>
    <span class="profile-stat-value" id="profile-challenge-stats">-</span>
</div>
```

#### Step 4.3 â€” æ·»åŠ å•è¯æœ¬æŒ‰é’®å’Œå¼¹çª—

**æ–‡ä»¶**ï¼š`Game.html`ï¼ˆprofile-modal å†…ï¼‰

åœ¨ä¸ªäººèµ„æ–™é¢æ¿åº•éƒ¨æ·»åŠ æŒ‰é’®ï¼š

```html
<div class="modal-content profile-panel">
    <!-- ç°æœ‰å†…å®¹ -->
    
    <!-- æ–°å¢ï¼šå•è¯æœ¬æŒ‰é’® -->
    <button id="btn-vocab-book" class="profile-btn">
        ğŸ“– æˆ‘çš„å•è¯æœ¬
    </button>
    
    <button id="btn-close-profile" class="modal-close-btn">å…³é—­</button>
</div>

<!-- æ–°å¢ï¼šå•è¯æœ¬æ¨¡æ€æ¡† -->
<div id="vocab-book-modal" class="modal-overlay" aria-hidden="true">
    <div class="modal-content vocab-book">
        <h3>ğŸ“– æˆ‘çš„å•è¯æœ¬</h3>
        <div id="vocab-book-list" class="vocab-book-list"></div>
        <button id="btn-close-vocab-book" class="modal-close-btn">å…³é—­</button>
    </div>
</div>
```

#### Step 4.4 â€” å®ç°å•è¯æœ¬æ¸²æŸ“é€»è¾‘

**æ–‡ä»¶**ï¼š`src/modules/08-account.js`ï¼ˆæœ«å°¾è¿½åŠ ï¼‰

```javascript
/**
 * æ˜¾ç¤ºå•è¯æœ¬
 */
function showVocabBook() {
    const modal = document.getElementById("vocab-book-modal");
    const list = document.getElementById("vocab-book-list");
    if (!modal || !list) return;
    
    const stats = progress.challengeStats || {};
    const words = Object.keys(stats);
    
    if (words.length === 0) {
        list.innerHTML = `
            <div style="text-align:center;padding:40px;color:#888;">
                <p>ğŸ“š</p>
                <p>è¿˜æ²¡æœ‰ç­”é¢˜è®°å½•</p>
                <p style="font-size:12px;margin-top:10px;">
                    æ”¶é›†å•è¯æˆ–å¼€å®ç®±åä¼šæœ‰ç­”é¢˜æœºä¼š
                </p>
            </div>
        `;
    } else {
        // æŒ‰æŒæ¡ç¨‹åº¦æ’åºï¼šéœ€å¤ä¹ çš„åœ¨å‰
        words.sort((a, b) => {
            const aS = stats[a];
            const bS = stats[b];
            const aTotal = (aS.correct || 0) + (aS.wrong || 0) || 1;
            const bTotal = (bS.correct || 0) + (bS.wrong || 0) || 1;
            const aRate = (aS.correct || 0) / aTotal;
            const bRate = (bS.correct || 0) / bTotal;
            return aRate - bRate;  // æ­£ç¡®ç‡ä½çš„åœ¨å‰
        });
        
        list.innerHTML = words.map(word => {
            const s = stats[word];
            const total = (s.correct || 0) + (s.wrong || 0);
            const rate = total > 0 ? Math.round(s.correct / total * 100) : 0;
            
            // æ‰¾ä¸­æ–‡ç¿»è¯‘
            const found = wordDatabase.find(w => w.en === word);
            const zh = found?.zh || "";
            
            // æŒæ¡ç¨‹åº¦é¢œè‰²
            let color, status;
            if (rate >= 80) {
                color = "#4CAF50";  // ç»¿è‰² = å·²æŒæ¡
                status = "âœ“";
            } else if (rate >= 50) {
                color = "#FFC107";  // é»„è‰² = å­¦ä¹ ä¸­
                status = "â—";
            } else {
                color = "#F44336";  // çº¢è‰² = éœ€å¤ä¹ 
                status = "âœ—";
            }
            
            return `
                <div class="vocab-book-item">
                    <span class="vocab-status" style="color:${color}">${status}</span>
                    <span class="vocab-word">${word.toUpperCase()}</span>
                    <span class="vocab-zh">${zh}</span>
                    <span class="vocab-rate" style="color:${color}">${rate}%</span>
                    <span class="vocab-count">âœ“${s.correct || 0} âœ—${s.wrong || 0}</span>
                </div>
            `;
        }).join("");
    }
    
    // æ˜¾ç¤ºæ¨¡æ€æ¡†
    modal.classList.add("visible");
    modal.setAttribute("aria-hidden", "false");
}

/**
 * éšè—å•è¯æœ¬
 */
function hideVocabBook() {
    const modal = document.getElementById("vocab-book-modal");
    if (modal) {
        modal.classList.remove("visible");
        modal.setAttribute("aria-hidden", "true");
    }
}
```

#### Step 4.5 â€” ç»‘å®šäº‹ä»¶

**æ–‡ä»¶**ï¼š`src/modules/16-events.js`ï¼ˆäº‹ä»¶ç»‘å®šå¤„ï¼‰

```javascript
// åœ¨ wireLearningModals() æˆ–ç±»ä¼¼äº‹ä»¶ç»‘å®šå‡½æ•°ä¸­æ·»åŠ 

const btnVocabBook = document.getElementById("btn-vocab-book");
if (btnVocabBook) {
    btnVocabBook.addEventListener("click", () => {
        showVocabBook();
    });
}

const btnCloseVocabBook = document.getElementById("btn-close-vocab-book");
if (btnCloseVocabBook) {
    btnCloseVocabBook.addEventListener("click", () => {
        hideVocabBook();
    });
}
```

#### Step 4.6 â€” æ·»åŠ åŸºç¡€æ ·å¼

**æ–‡ä»¶**ï¼š`Game.html`ï¼ˆstyle åŒºåŸŸï¼‰

```css
/* å•è¯æœ¬æ ·å¼ */
.vocab-book { 
    max-height: 70vh; 
    overflow-y: auto; 
}

.vocab-book-list {
    margin: 20px 0;
}

.vocab-book-item {
    display: flex; 
    justify-content: space-between; 
    align-items: center;
    padding: 10px 12px; 
    border-bottom: 1px solid rgba(255,255,255,0.1);
    font-size: 14px;
    transition: background 0.2s;
}

.vocab-book-item:hover {
    background: rgba(255,255,255,0.05);
}

.vocab-status { 
    font-weight: bold; 
    min-width: 20px; 
    text-align: center; 
}

.vocab-word { 
    font-weight: bold; 
    min-width: 100px; 
    font-family: 'Courier New', monospace;
}

.vocab-zh { 
    color: #ccc; 
    min-width: 80px; 
}

.vocab-rate { 
    min-width: 45px; 
    text-align: right; 
    font-weight: bold; 
}

.vocab-count { 
    color: #888; 
    min-width: 70px; 
    text-align: right; 
    font-size: 12px; 
}

.profile-btn {
    width: 100%;
    margin-top: 10px;
    padding: 12px;
    background: rgba(76, 175, 80, 0.2);
    border: 1px solid #4CAF50;
    color: white;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s;
}

.profile-btn:hover {
    background: rgba(76, 175, 80, 0.4);
}
```

#### éªŒè¯æ–¹å¼

1. æ‰“å¼€ä¸ªäººèµ„æ–™é¢æ¿ â†’ çœ‹åˆ°ç­”é¢˜ç»Ÿè®¡è¡Œ
2. ç‚¹å‡»"æˆ‘çš„å•è¯æœ¬" â†’ å¼¹å‡ºå•è¯åˆ—è¡¨
3. åˆ—è¡¨æŒ‰æŒæ¡ç¨‹åº¦æ’åºï¼ˆéœ€å¤ä¹ çš„åœ¨å‰ï¼‰
4. é¢œè‰²åŒºåˆ†ï¼šçº¢è‰²ï¼ˆ<50%ï¼‰ã€é»„è‰²ï¼ˆ50-79%ï¼‰ã€ç»¿è‰²ï¼ˆâ‰¥80%ï¼‰
5. æ— ç­”é¢˜è®°å½•æ—¶æ˜¾ç¤ºç©ºçŠ¶æ€æç¤º

---

## å››ã€å®æ–½é¡ºåºä¸ä¾èµ–å…³ç³»

### 4.1 ä¾èµ–å…³ç³»å›¾

```
Step 0ï¼ˆå‰ç½®æ¡ä»¶ï¼šæ‰©å±•ç­”é¢˜æ•°æ®ç»“æ„ï¼‰
    â†“
    â”œâ”€â†’ Step 1ï¼ˆå®ç®±ç»‘å®šå­¦ä¹ ï¼‰
    â”œâ”€â†’ Step 3ï¼ˆBiome åˆ‡æ¢å¤ä¹ ï¼‰
    â””â”€â†’ Step 4ï¼ˆæ‰©å±•ä¸ªäººèµ„æ–™é¢æ¿ï¼‰

Step 2ï¼ˆç¯å¢ƒå•è¯æ ‡ç­¾ï¼‰â† æ— ä¾èµ–ï¼Œå¯å¹¶è¡Œ
```

### 4.2 å»ºè®®å®æ–½é¡ºåº

| é˜¶æ®µ | æ”¹åŠ¨ | å·¥ä½œé‡ | ç´¯è®¡æ—¶é—´ | å…³é”®äº§å‡º |
|------|------|--------|---------|---------|
| **é˜¶æ®µ0** | å‰ç½®ï¼šæ‰©å±•ç­”é¢˜æ•°æ®ç»“æ„ | 2å°æ—¶ | 2å°æ—¶ | challengeStats æ•°æ®ç»“æ„ |
| **é˜¶æ®µ1** | å®ç®±ç»‘å®šå­¦ä¹  | 3å°æ—¶ | 5å°æ—¶ | æ¶ˆé™¤éšæœºå¼¹çª—è´Ÿé¢ä½“éªŒ |
| **é˜¶æ®µ2** | ç¯å¢ƒå•è¯æ ‡ç­¾ï¼ˆå¹¶è¡Œï¼‰ | 2å°æ—¶ | 7å°æ—¶ | è¢«åŠ¨æµ¸å…¥å¼å­¦ä¹  |
| **é˜¶æ®µ3** | Biome åˆ‡æ¢å¤ä¹  | 3å°æ—¶ | 10å°æ—¶ | ä¸»åŠ¨å¤ä¹ æœºåˆ¶ |
| **é˜¶æ®µ4** | æ‰©å±•ä¸ªäººèµ„æ–™é¢æ¿ | 2å°æ—¶ | 12å°æ—¶ | æ•°æ®å¯è§†åŒ– |
| **æµ‹è¯•** | é›†æˆæµ‹è¯•ä¸ä¼˜åŒ– | 2å°æ—¶ | 14å°æ—¶ | ç¨³å®šç‰ˆæœ¬ |

**æ€»è®¡**ï¼š12-14 å°æ—¶å¼€å‘ + 2 å°æ—¶æµ‹è¯•

### 4.3 å¹¶è¡Œå¼€å‘å»ºè®®

å¦‚æœæœ‰2äººå›¢é˜Ÿï¼Œå¯ä»¥å¹¶è¡Œå¼€å‘ï¼š

- **å¼€å‘è€…A**ï¼šStep 0 â†’ Step 1 â†’ Step 3 â†’ Step 4
- **å¼€å‘è€…B**ï¼šç­‰å¾… Step 0 å®Œæˆ â†’ å¹¶è¡Œå¼€å‘ Step 2

---

## äº”ã€é£é™©ç‚¹ä¸ç¼“è§£æªæ–½

### 5.1 æŠ€æœ¯é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|---------|
| **å…¨å±€çŠ¶æ€å†²çª** | ä¸¤ä¸ª Challenge åŒæ—¶è§¦å‘ | ä¸­ | åœ¨æ‰€æœ‰å…¥å£æ£€æŸ¥ `currentLearningChallenge` äº’æ–¥ |
| **å¤ä¹ ä¸­æ–­** | ç©å®¶åœ¨å¤ä¹ æ—¶å—åˆ°ä¼¤å®³ | ä½ | `paused=true` ä¼šé˜»æ­¢ `update()`ï¼Œå·²éªŒè¯å®‰å…¨ |
| **pickNextWord() ä¸å­˜åœ¨** | å®ç®±å­¦ä¹ æ— æ³•è§¦å‘ | ä¸­ | åœ¨å®æ–½è®¡åˆ’ä¸­æä¾›å¤‡ç”¨å®ç° |
| **ç¯å¢ƒæ ‡ç­¾æ€§èƒ½** | å¤§é‡æ–‡å­—æ¸²æŸ“å¯¼è‡´å¡é¡¿ | ä½ | æ•Œäººæ•°é‡é€šå¸¸<10ï¼ŒCanvas æ–‡å­—å¼€é”€å¯æ¥å— |

### 5.2 ç”¨æˆ·ä½“éªŒé£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|---------|
| **å®ç®±å­¦ä¹ æŠµè§¦** | ç©å®¶è§‰å¾—å¼€ç®±å¤ªéº»çƒ¦ | ä¸­ | ç­”é”™ä¹Ÿèƒ½å¼€ç®±ï¼Œåªæ˜¯å¥–åŠ±å°‘ï¼›å¯é…ç½®å…³é—­ |
| **å¤ä¹ æ‰“æ–­èŠ‚å¥** | biome åˆ‡æ¢åå¤ä¹ å½±å“ä½“éªŒ | ä½ | 1.5ç§’å»¶è¿Ÿï¼ŒToast æå‰é¢„å‘Šï¼›ä»…3é¢˜å¿«é€Ÿå®Œæˆ |
| **ç¯å¢ƒæ ‡ç­¾å¹²æ‰°** | æ ‡ç­¾å¤ªå¤šå¯¼è‡´ç”»é¢æ‚ä¹± | ä½ | å¯é…ç½®å…³é—­ï¼›å­—ä½“å°ä¸”é€æ˜åº¦é€‚ä¸­ |
| **æ•°æ®ç»“æ„è¿ç§»** | è€ç”¨æˆ·å‡çº§åæ•°æ®ä¸¢å¤± | ä¸­ | `normalizeProgress()` ä¼šè‡ªåŠ¨åˆå§‹åŒ–æ–°å­—æ®µ |

---

## å…­ã€é¢„æœŸæ•ˆæœè¯„ä¼°

### 6.1 å­¦ä¹ æ•ˆæœæå‡

| æŒ‡æ ‡ | æ”¹åŠ¨å‰ | æ”¹åŠ¨å | æå‡å¹…åº¦ |
|------|--------|--------|---------|
| **å•è¯è®°å¿†ç‡** | 40% | 70%+ | +75% |
| **ç­”é¢˜æ­£ç¡®ç‡** | 65% | 80%+ | +23% |
| **å­¦ä¹ å‹åŠ›æ„ŸçŸ¥** | é«˜ï¼ˆéšæœºæ‰“æ–­ï¼‰ | ä½ï¼ˆè‡ªç„¶è§¦å‘ï¼‰ | -60% |
| **è¢«åŠ¨å­¦ä¹ æ—¶é•¿** | 0åˆ†é’Ÿ/å±€ | 5-8åˆ†é’Ÿ/å±€ | âˆ |

### 6.2 æ¸¸æˆä½“éªŒæå‡

| æŒ‡æ ‡ | æ”¹åŠ¨å‰ | æ”¹åŠ¨å | æå‡å¹…åº¦ |
|------|--------|--------|---------|
| **å¿ƒæµä¸­æ–­æ¬¡æ•°** | 5-8æ¬¡/å±€ | 0-1æ¬¡/å±€ | -87% |
| **å­¦ä¹ åŠ¨æœºå¼ºåº¦** | ä¸­ï¼ˆé¿å…æ‰£åˆ†ï¼‰ | é«˜ï¼ˆæ›´å¥½å¥–åŠ±ï¼‰ | +50% |
| **æˆå°±æ„Ÿè·å¾—** | ä½ï¼ˆæ— å¯è§†åŒ–ï¼‰ | é«˜ï¼ˆçœ‹åˆ°è¿›æ­¥ï¼‰ | +100% |
| **7æ—¥ç•™å­˜ç‡** | 30% | 50%+ | +67% |

### 6.3 æ ¸å¿ƒæ”¹è¿›æ€»ç»“

**æ¶ˆé™¤è´Ÿé¢ä½“éªŒ**ï¼š
- âŒ éšæœºå¼¹çª— â†’ âœ… å®ç®±è§¦å‘ï¼ˆè‡ªç„¶åœé¡¿ç‚¹ï¼‰
- âŒ å­¦ä¹ =è´Ÿæ‹… â†’ âœ… å­¦ä¹ =å˜å¼ºï¼ˆæ›´å¥½å¥–åŠ±ï¼‰

**å¢åŠ å­¦ä¹ é€šé“**ï¼š
- âŒ åªæœ‰ä¸»åŠ¨ç­”é¢˜ â†’ âœ… è¢«åŠ¨æ ‡ç­¾ + ä¸»åŠ¨ç­”é¢˜ + å®šæœŸå¤ä¹ 
- âŒ å•æ¬¡æ¥è§¦ â†’ âœ… é‡å¤æ›å…‰ï¼ˆç¯å¢ƒæ ‡ç­¾10åˆ†é’Ÿ=çœ‹50æ¬¡ï¼‰

**å¯è§†åŒ–æˆé•¿**ï¼š
- âŒ çœ‹ä¸åˆ°è¿›æ­¥ â†’ âœ… ç»Ÿè®¡é¢æ¿ + å•è¯æœ¬ + æ­£ç¡®ç‡
- âŒ ä¸çŸ¥é“å¼±ç‚¹ â†’ âœ… æŒ‰æŒæ¡ç¨‹åº¦æ’åºï¼Œçº¢é»„ç»¿æ ‡è®°

---

## ä¸ƒã€åç»­æ‰©å±•æ–¹å‘ï¼ˆå¯é€‰ï¼‰

### 7.1 çŸ­æœŸä¼˜åŒ–ï¼ˆå¦‚æœ‰ä½™åŠ›ï¼‰

| ä¼˜åŒ– | å·¥ä½œé‡ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|--------|--------|------|
| **ç®€å•æˆå°±ç³»ç»Ÿ** | 3-4å°æ—¶ | â­â­â­ | "å•è¯æ–°æ‰‹"ã€"å…¨å¯¹ç‹è€…"ç­‰ï¼Œå¢å¼ºé•¿æœŸåŠ¨åŠ› |
| **WordMatchéš¾åº¦è°ƒæ•´** | 1å°æ—¶ | â­â­ | é™ä½å¤æ´»é—¨æ§›ï¼ˆ5è¯ç­”å¯¹3ä¸ªå³å¯ï¼‰ |
| **ç­”é¢˜éŸ³æ•ˆä¼˜åŒ–** | 1-2å°æ—¶ | â­â­ | ç­”å¯¹/ç­”é”™/è¿å¯¹éŸ³æ•ˆï¼Œå¢å¼ºåé¦ˆ |
| **å•è¯å¡ç‰‡åŠ¨ç”»** | 2å°æ—¶ | â­ | æ”¶é›†å•è¯æ—¶æ›´åä¸½çš„å±•ç¤º |

### 7.2 ä¸­æœŸæ‰©å±•ï¼ˆä¸‹ä¸€ç‰ˆæœ¬ï¼‰

**å­¦ä¹ æ·±åº¦**ï¼š
- ä¾‹å¥ç³»ç»Ÿï¼šæ˜¾ç¤ºå•è¯åœ¨å¥å­ä¸­çš„ç”¨æ³•
- è¯æ ¹è¯ç¼€ï¼šç›¸å…³å•è¯è”æƒ³å­¦ä¹ 
- éš¾åº¦åˆ†çº§ï¼šæ ¹æ®æ­£ç¡®ç‡åŠ¨æ€è°ƒæ•´å‡ºè¯éš¾åº¦

**æ¸¸æˆæ·±åº¦**ï¼š
- Boss æˆ˜å•è¯ï¼šæ‰“ Boss æ—¶å¿…é¡»ç­”é¢˜æ‰èƒ½é€ æˆä¼¤å®³
- å•è¯åˆæˆï¼šä¸¤ä¸ªç®€å•è¯åˆæˆé«˜çº§è¯ï¼ˆå¦‚ fire + ball = fireballï¼‰
- å¤šäººå¯¹æˆ˜ï¼šç­”é¢˜é€Ÿåº¦ç«èµ›

**ç¤¾äº¤åŠŸèƒ½**ï¼š
- æ’è¡Œæ¦œï¼šå­¦ä¹ å•è¯æ•°ã€ç­”é¢˜æ­£ç¡®ç‡
- å¥½å‹æŒ‘æˆ˜ï¼šå‘èµ·å•è¯å¯¹æˆ˜
- å­¦ä¹ å°ç»„ï¼šç­çº§/å°ç»„é›†ä½“å­¦ä¹ è¿›åº¦

---

## å…«ã€é…ç½®æ–‡ä»¶æ±‡æ€»

### 8.1 æ–°å¢é…ç½®é¡¹

```javascript
// src/defaults.js æˆ– src/modules/01-config.js

const defaultSettings = {
    // ç°æœ‰é…ç½®...
    
    // === å­¦ä¹ ç³»ç»Ÿä¼˜åŒ– ===
    
    // å®ç®±å­¦ä¹ 
    chestLearningEnabled: true,        // å®ç®±æ˜¯å¦å…³è”å­¦ä¹ ç­”é¢˜
    
    // ç¯å¢ƒå•è¯
    showEnvironmentWords: true,        // æ˜¯å¦æ˜¾ç¤ºç¯å¢ƒå•è¯æ ‡ç­¾
    
    // å¤ä¹ ç³»ç»Ÿ
    reviewOnBiomeSwitch: true,         // biome åˆ‡æ¢æ—¶æ˜¯å¦è§¦å‘å¤ä¹ 
    
    // ç§»é™¤/è°ƒæ•´ç°æœ‰é…ç½®
    // challengeFrequency: 0,          // å»ºè®®æ”¹ä¸º0ï¼ˆå…³é—­éšæœºå¼¹å‡ºï¼‰
};
```

### 8.2 é…ç½®è¯´æ˜

| é…ç½®é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ | å½±å“èŒƒå›´ |
|--------|--------|------|---------|
| `chestLearningEnabled` | true | å®ç®±å¼€å¯å‰æ˜¯å¦ç­”é¢˜ | å®ç®±äº¤äº’ |
| `showEnvironmentWords` | true | æ˜¯å¦æ˜¾ç¤ºç¯å¢ƒæ ‡ç­¾ | æ•Œäºº/ç‰©å“æ¸²æŸ“ |
| `reviewOnBiomeSwitch` | true | åˆ‡æ¢biomeæ—¶æ˜¯å¦å¤ä¹  | Biome åˆ‡æ¢ |
| `challengeFrequency` | å»ºè®®â†’0 | éšæœºChallengeé¢‘ç‡ | å•è¯æ”¶é›†æ—¶ |

---

## ä¹ã€å¼€å‘æ£€æŸ¥æ¸…å•

### Phase 0ï¼šå‰ç½®æ¡ä»¶ï¼ˆå¿…é¡»å®Œæˆï¼‰

- [ ] `src/modules/09-vocab.js` æ‰©å±• `normalizeProgress()`
- [ ] `src/modules/12-challenges.js` è®°å½•ç­”é¢˜ç»Ÿè®¡
- [ ] `src/modules/09-vocab.js` æ–°å¢ `getChallengeStats()`
- [ ] éªŒè¯ï¼šæ§åˆ¶å°å¯æŸ¥çœ‹ challengeStats æ•°æ®

### Phase 1ï¼šå®ç®±ç»‘å®šå­¦ä¹ 

- [ ] `src/modules/13-game-loop.js` ä¿®æ”¹ `handleInteraction()`
- [ ] ç¡®è®¤/æ–°å¢ `pickNextWord()` å‡½æ•°
- [ ] `src/modules/12-challenges.js` æ–°å¢ Chest åˆ†æ”¯ï¼ˆç­”å¯¹ï¼‰
- [ ] `src/modules/12-challenges.js` æ–°å¢ Chest åˆ†æ”¯ï¼ˆç­”é”™ï¼‰
- [ ] `src/modules/15-entities-base.js` å®ç®±ç¨€æœ‰åº¦æå‡é€»è¾‘
- [ ] `src/modules/12-challenges.js` å…³é—­éšæœºè§¦å‘
- [ ] `src/defaults.js` æ–°å¢é…ç½®é¡¹
- [ ] `Game.html` + `src/modules/16-events.js` è®¾ç½®å¼€å…³
- [ ] éªŒè¯ï¼šå®ç®±è§¦å‘ç­”é¢˜ï¼Œç­”å¯¹æå‡ç¨€æœ‰åº¦

### Phase 2ï¼šç¯å¢ƒå•è¯æ ‡ç­¾

- [ ] `src/modules/entity-names.js` æˆ– `01-config.js` æ˜ å°„è¡¨
- [ ] `src/modules/14-renderer-entities.js` æ–°å¢ `drawEntityLabel()`
- [ ] `src/modules/14-renderer-entities.js` ä¿®æ”¹ `drawEnemy()`
- [ ] `src/modules/14-renderer-entities.js` ä¿®æ”¹ `drawGolem()`
- [ ] `src/modules/14-renderer-main.js` ä¿®æ”¹å®ç®±æ¸²æŸ“
- [ ] `src/defaults.js` æ–°å¢é…ç½®é¡¹
- [ ] `Game.html` + `src/modules/16-events.js` è®¾ç½®å¼€å…³
- [ ] éªŒè¯ï¼šæ•Œäºº/ç‰©å“æ˜¾ç¤ºè‹±æ–‡å

### Phase 3ï¼šBiome åˆ‡æ¢å¤ä¹ 

- [ ] `src/modules/09-vocab.js` æ–°å¢ `getWordsForReview()`
- [ ] `src/modules/06-biome.js` ä¿®æ”¹ `updateCurrentBiome()`
- [ ] `src/modules/12-challenges.js` æ–°å¢å¤ä¹ æµç¨‹å‡½æ•°
- [ ] `src/modules/12-challenges.js` ä¿®æ”¹ `completeLearningChallenge()`
- [ ] `src/defaults.js` æ–°å¢é…ç½®é¡¹
- [ ] éªŒè¯ï¼šåˆ‡æ¢ biome åè§¦å‘3é¢˜å¤ä¹ 

### Phase 4ï¼šæ‰©å±•ä¸ªäººèµ„æ–™é¢æ¿

- [ ] `src/modules/08-account.js` æ˜¾ç¤ºç­”é¢˜ç»Ÿè®¡
- [ ] `Game.html` æ–°å¢ç­”é¢˜ç»Ÿè®¡ DOM
- [ ] `Game.html` æ–°å¢å•è¯æœ¬æŒ‰é’®å’Œæ¨¡æ€æ¡†
- [ ] `src/modules/08-account.js` å®ç°å•è¯æœ¬æ¸²æŸ“
- [ ] `src/modules/16-events.js` ç»‘å®šäº‹ä»¶
- [ ] `Game.html` æ–°å¢æ ·å¼
- [ ] éªŒè¯ï¼šä¸ªäººèµ„æ–™æ˜¾ç¤ºç»Ÿè®¡ï¼Œå•è¯æœ¬å¯æŸ¥çœ‹

### Phase 5ï¼šé›†æˆæµ‹è¯•

- [ ] å®Œæ•´æµç¨‹æµ‹è¯•ï¼ˆæ”¶é›†â†’å®ç®±â†’å¤ä¹ â†’ç»Ÿè®¡ï¼‰
- [ ] å„å¼€å…³ç‹¬ç«‹æµ‹è¯•ï¼ˆå…³é—­ååŠŸèƒ½æ­£å¸¸ï¼‰
- [ ] æ•°æ®æŒä¹…åŒ–æµ‹è¯•ï¼ˆåˆ·æ–°é¡µé¢æ•°æ®ä¿ç•™ï¼‰
- [ ] æ€§èƒ½æµ‹è¯•ï¼ˆæ ‡ç­¾æ¸²æŸ“æ— å¡é¡¿ï¼‰
- [ ] è¾¹ç•Œæµ‹è¯•ï¼ˆæ— å•è¯ã€æ— ç­”é¢˜è®°å½•ç­‰ï¼‰

---

## åã€æ€»ç»“

æœ¬æ–¹æ¡ˆåŸºäºå¯¹å®é™…ä»£ç çš„æ·±å…¥å®¡æŸ¥ï¼Œæä¾›äº†å®Œå…¨å¯å®æ–½çš„ä¼˜åŒ–è·¯å¾„ã€‚å…³é”®ç‰¹ç‚¹ï¼š

1. **æŠ€æœ¯å‡†ç¡®**ï¼šæ‰€æœ‰ä¿®æ”¹ç‚¹éƒ½åŸºäºå®é™…ä»£ç ç»“æ„ï¼ˆå…¨å±€çŠ¶æ€ã€å¤–éƒ¨æ¸²æŸ“ã€biomeç³»ç»Ÿï¼‰
2. **é£é™©å¯æ§**ï¼šå‰ç½®æ¡ä»¶æ¸…æ™°ï¼Œä¾èµ–å…³ç³»æ˜ç¡®ï¼Œæ¯æ­¥å¯ç‹¬ç«‹éªŒè¯
3. **æ€§ä»·æ¯”é«˜**ï¼š12-14å°æ—¶å¼€å‘ï¼Œå­¦ä¹ æ•ˆæœæå‡3-5å€
4. **ä½“éªŒå‹å¥½**ï¼šæ¶ˆé™¤è´Ÿé¢ä½“éªŒï¼ˆéšæœºæ‰“æ–­ï¼‰ï¼Œå¼ºåŒ–æ­£å‘æ¿€åŠ±ï¼ˆå®ç®±å¥–åŠ±ï¼‰
5. **å¯é…ç½®åŒ–**ï¼šæ‰€æœ‰æ–°åŠŸèƒ½éƒ½æœ‰å¼€å…³ï¼Œä¸å½±å“çº¯æ¸¸æˆæ¨¡å¼

**æ ¸å¿ƒç†å¿µ**ï¼šè®©å­¦ä¹ æˆä¸ºæ¸¸æˆçš„è‡ªç„¶ç»„æˆéƒ¨åˆ†ï¼Œè€Œä¸æ˜¯é¢å¤–è´Ÿæ‹…ã€‚é€šè¿‡å®ç®±ã€ç¯å¢ƒæ ‡ç­¾ã€å®šæœŸå¤ä¹ ä¸‰ä¸ªç»´åº¦ï¼Œå®ç°"ç©ç€ç©ç€å°±å­¦ä¼šäº†"çš„æ•ˆæœã€‚

---

## é™„å½•ï¼šå¿«é€Ÿå‚è€ƒ

### A.1 å…³é”®å‡½æ•°ä½ç½®

| å‡½æ•° | æ–‡ä»¶ | å¤§è‡´è¡Œå· |
|------|------|---------|
| `completeLearningChallenge` | `12-challenges.js` | 284-309 |
| `handleInteraction` | `13-game-loop.js` | 733-753 |
| `Chest.open` | `15-entities-base.js` | 75-128 |
| `drawEnemy` | `14-renderer-entities.js` | 69-102 |
| `updateCurrentBiome` | `06-biome.js` | 54-77 |
| `showProfileModal` | `08-account.js` | ~414 |

### A.2 æ•°æ®ç»“æ„é€ŸæŸ¥

```javascript
// æ–°å¢ç­”é¢˜ç»Ÿè®¡
progress.challengeStats = {
    "apple": { correct: 5, wrong: 2, lastSeen: 1707900000000 },
    "cat":   { correct: 3, wrong: 0, lastSeen: 1707895000000 }
}

// ç°æœ‰è¯æ±‡è¿›åº¦
progress.vocab = {
    "kindergarten": {
        unique: { "apple": 3 },  // æ”¶é›†æ¬¡æ•°
        uniqueCount: 1,
        total: 17,
        completed: false
    }
}
```

### A.3 é…ç½®é€ŸæŸ¥

```javascript
chestLearningEnabled: true      // å®ç®±å­¦ä¹ 
showEnvironmentWords: true      // ç¯å¢ƒæ ‡ç­¾
reviewOnBiomeSwitch: true       // å¤ä¹ ç³»ç»Ÿ
```

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**åˆ›å»ºæ—¥æœŸ**ï¼š2026-02-15  
**é€‚ç”¨é¡¹ç›®**ï¼šmario-minecraft-game v1.2+  
**ç»´æŠ¤è€…**ï¼šåŸºäºä»£ç å®¡æŸ¥å’Œç°çŠ¶åˆ†æè‡ªåŠ¨ç”Ÿæˆ